<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="React, Sunny">
    <meta name="description" content="React 概述
官网：https://react.docschina.org/

什么是 React？React 是由Facebook研发的、用于解决 UI 复杂度的开源JavaScript 库，目前由 React 联合社区维护。

它不">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>React | Sunny</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Sunny</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Sunny</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/15.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">React</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Front-end-article/">
                                <span class="chip bg-color">Front end article</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-07-01
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="React-概述"><a href="#React-概述" class="headerlink" title="React 概述"></a>React 概述</h1><blockquote>
<p>官网：<a target="_blank" rel="noopener" href="https://react.docschina.org/">https://react.docschina.org/</a></p>
</blockquote>
<h2 id="什么是-React？"><a href="#什么是-React？" class="headerlink" title="什么是 React？"></a>什么是 React？</h2><p>React 是由<strong>Facebook</strong>研发的、用于<strong>解决 UI 复杂度</strong>的开源<strong>JavaScript 库</strong>，目前由 React 联合社区维护。</p>
<blockquote>
<p>它不是框架，只是为了解决 UI 复杂度而诞生的一个库<br>不是 MVVM MVC</p>
</blockquote>
<h2 id="React-的特点"><a href="#React-的特点" class="headerlink" title="React 的特点"></a>React 的特点</h2><ul>
<li>轻量：React 的开发版所有源码（包含注释）仅 3000 多行</li>
<li>原生：所有的 React 的代码都是用原生 JS 书写而成的，不依赖其他任何库</li>
<li>易扩展：React 对代码的封装程度较低，也没有过多的使用魔法，所以 React 中的很多功能都可以扩展。</li>
<li>不依赖宿主环境：React 只依赖原生 JS 语言，不依赖任何其他东西，包括运行环境。因此，它可以被轻松的移植到浏览器、桌面应用、移动端。</li>
<li>渐近式：React 并非框架，对整个工程没有强制约束力。这对与那些已存在的工程，可以逐步的将其改造为 React，而不需要全盘重写。</li>
<li>单向数据流：所有的数据自顶而下的流动</li>
<li>用 JS 代码声明界面</li>
<li>组件化</li>
</ul>
<h2 id="对比-Vue"><a href="#对比-Vue" class="headerlink" title="对比 Vue"></a>对比 Vue</h2><table>
<thead>
<tr>
<th>对比项</th>
<th>Vue</th>
<th>React</th>
</tr>
</thead>
<tbody><tr>
<td>全球使用量</td>
<td></td>
<td>✔</td>
</tr>
<tr>
<td>国内使用量</td>
<td>✔</td>
<td></td>
</tr>
<tr>
<td>性能</td>
<td>✔</td>
<td>✔</td>
</tr>
<tr>
<td>易上手</td>
<td>✔</td>
<td></td>
</tr>
<tr>
<td>灵活度</td>
<td></td>
<td>✔</td>
</tr>
<tr>
<td>大型企业</td>
<td></td>
<td>✔</td>
</tr>
<tr>
<td>中小型企业</td>
<td>✔</td>
<td></td>
</tr>
<tr>
<td>生态</td>
<td></td>
<td>✔</td>
</tr>
</tbody></table>
<h2 id="路径"><a href="#路径" class="headerlink" title="路径"></a>路径</h2><p>整体原则：熟悉 API –&gt; 深入理解原理</p>
<ol>
<li><p>React</p>
<ol>
<li>基础：掌握 React 的基本使用方法，有能力制作各种组件，并理解其基本运作原理</li>
<li>进阶：掌握 React 中的一些黑科技，提高代码质量</li>
</ol>
</li>
<li><p>React-Router：相当于 vue-router</p>
</li>
<li><p>Redux：相当于 Vuex</p>
<ol>
<li>Redux 本身</li>
<li>各种中间件</li>
</ol>
</li>
<li><p>第三方脚手架：umi</p>
</li>
<li><p>UI 库：Ant Design，相当于 Vue 的 Element-UI 或 IView</p>
</li>
<li><p>源码部分</p>
<ol>
<li>React 源码分析</li>
<li>Redux 源码分析</li>
</ol>
</li>
</ol>
<h2 id="关于课程"><a href="#关于课程" class="headerlink" title="关于课程"></a>关于课程</h2><ul>
<li>demo 关键字：课程名称前有<strong>demo</strong>字样的，为一个小练习，需要同学听完讲解后自行独立完成</li>
<li>扩展关键字：课程名称前有<strong>扩展</strong>字样的，为选修内容，没有掌握不会影响后面的学习</li>
<li>关于源代码：本门课所有源代码均使用 git 管理，每节课的代码为独立分支，但某些文件夹和文件不属于源代码管理范畴。</li>
<li>关于 npm：本门课所有的第三方库安装，均使用 yarn（有缓存）</li>
</ul>
<h1 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h1><p>直接在页面上使用 React，引用下面的 JS</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- React的核心库，与宿主环境无关 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
  <span class="token attr-name">crossorigin</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/react@16/umd/react.development.js<span class="token punctuation">"</span></span>
<span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- 依赖核心库，将核心的功能与页面结合 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
  <span class="token attr-name">crossorigin</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/react-dom@16/umd/react-dom.development.js<span class="token punctuation">"</span></span>
<span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
crossorigin跨域。script本身可以跨域，为何还要加呢？报错会显示详细信息<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="React-createElement"><a href="#React-createElement" class="headerlink" title="React.createElement"></a>React.createElement</h2><p>创建一个<strong>React 元素</strong>，称作虚拟 DOM，<strong>本质上是一个对象</strong></p>
<ol>
<li>参数 1：元素类型，如果是字符串，一个普通的 HTML 元素</li>
<li>参数 2：元素的属性，一个对象</li>
<li>后续参数：元素的子节点</li>
</ol>
<p>最原始的写法：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// 创建一个span元素</span>
<span class="token keyword">var</span> span <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"一个span元素"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建一个h1元素</span>
创建一个<span class="token constant">H1</span>元素<span class="token punctuation">;</span>
<span class="token keyword">var</span> h1 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>
  <span class="token string">"h1"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span>
    title<span class="token operator">:</span> <span class="token string">"第一个React元素"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token string">"Hello"</span><span class="token punctuation">,</span>
  <span class="token string">"World"</span><span class="token punctuation">,</span>
  span
<span class="token punctuation">)</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>h1<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>React 本质：createElement 创建一个对象，把这些对象形成一种结构，最终交给 ReactDOM 渲染到页面上</p>
</blockquote>
<h2 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h2><p>JS 的扩展语法，需要使用 babel 进行转义。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 编译JSX --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/babel-standalone@6/babel.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/babel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">// 创建一个span元素</span>
  <span class="token keyword">var</span> span <span class="token operator">=</span> <span class="token operator">&lt;</span>span<span class="token operator">></span>一个span元素<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">// 创建一个H1元素</span>
  <span class="token keyword">var</span> h1 <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>h1 title<span class="token operator">=</span><span class="token string">"第一个React元素"</span><span class="token operator">></span>
      Hello World <span class="token operator">&lt;</span>span<span class="token operator">></span>一个span元素<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>h1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 等价于直接写    最终都会转成React.createElement来执行</span>
  <span class="token comment">// ReactDOM.render(&lt;h1 title="第一个React元素">Hello World &lt;span>一个span元素&lt;/span>&lt;/h1>, document.getElementById("root"));</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="使用脚手架搭建工程"><a href="#使用脚手架搭建工程" class="headerlink" title="使用脚手架搭建工程"></a>使用脚手架搭建工程</h1><p>官方：create-react-app 第三方：next.js、umijs<br>凡是使用 JSX 的文件，必须导入 React<br>​</p>
<p>搭建工程：yarn create react-app react-learn<br>​</p>
<p>yarn start 启动工程<br>yarn build 部署<br>​</p>
<h3 id="yarn-报“文件名、目录名或卷标语法不正确”错误的解决方案"><a href="#yarn-报“文件名、目录名或卷标语法不正确”错误的解决方案" class="headerlink" title="yarn 报“文件名、目录名或卷标语法不正确”错误的解决方案"></a>yarn 报“文件名、目录名或卷标语法不正确”错误的解决方案</h3><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904111570190349">https://juejin.cn/post/6844904111570190349</a><br>​</p>
<h1 id="开发环境搭建"><a href="#开发环境搭建" class="headerlink" title="开发环境搭建"></a>开发环境搭建</h1><h2 id="VSCode-配置"><a href="#VSCode-配置" class="headerlink" title="VSCode 配置"></a>VSCode 配置</h2><p>emmet 配置：emmet 语法书写代码</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"javascript"</span><span class="token operator">:</span> <span class="token string">"javascriptreact"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="VSCode-插件安装"><a href="#VSCode-插件安装" class="headerlink" title="VSCode 插件安装"></a>VSCode 插件安装</h2><ul>
<li><p>ESLint：代码风格检查：合适的时候提出警告</p>
</li>
<li><p>ES7 React/Redux/GraphQL/React-Native snippets：快速代码编写</p>
</li>
</ul>
<h2 id="Chrome-插件安装"><a href="#Chrome-插件安装" class="headerlink" title="Chrome 插件安装"></a>Chrome 插件安装</h2><p>React Developer Tools<br>​</p>
<h1 id="JSX-1"><a href="#JSX-1" class="headerlink" title="JSX"></a>JSX</h1><h2 id="什么是-JSX"><a href="#什么是-JSX" class="headerlink" title="什么是 JSX"></a>什么是 JSX</h2><ul>
<li>Facebook 起草的 JS 扩展语法</li>
<li>本质是一个 JS 对象，会被 babel 编译，最终会被转换为 React.createElement</li>
<li>每个 JSX 表达式，有且仅有一个根节点。原因：最终 React.createElement。<ul>
<li>React.Fragment 简写为 &lt;&gt;&lt;/&gt;</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> h1 <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">></span>标签<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">//防止混乱，加上括号</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>每个 JSX 元素必须结束（XML 规范）</li>
</ul>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// 例如img</span>
<span class="token keyword">const</span> img<span class="token operator">=</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>img</span><span class="token punctuation">></span></span>  标签结束
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token punctuation">/></span></span>		自结束
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="在-JSX-中嵌入表达式"><a href="#在-JSX-中嵌入表达式" class="headerlink" title="在 JSX 中嵌入表达式"></a>在 JSX 中嵌入表达式</h2><ul>
<li>在 JSX 中使用注释 ctrl+/</li>
<li>将表达式作为内容的一部分<ul>
<li>null、undefined、false 不会显示</li>
<li>普通对象，不可以作为子元素</li>
<li>可以放置 React 元素对象</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token operator">&lt;</span>span<span class="token operator">></span>这是span元素<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">&#123;</span>obj<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>数组：遍历数组，把数组的每一个元素当成子元素加进来，undefined null false 不会算，放普通对象会出错</li>
<li>将表达式作为元素属性</li>
<li>属性使用小驼峰命名法</li>
<li>防止注入攻击<ul>
<li>自动编码</li>
<li>dangerouslySetInnerHTML</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1234</span><span class="token punctuation">,</span>
  b <span class="token operator">=</span> <span class="token number">2345</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">></span>
    <span class="token punctuation">&#123;</span>a<span class="token punctuation">&#125;</span> <span class="token operator">*</span> <span class="token punctuation">&#123;</span>b<span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>a <span class="token operator">*</span> b<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 底层实现上</span>
<span class="token comment">// const div = React.createElement("div",&#123;&#125;,`$&#123;a&#125;*$&#123;b&#125; = $&#123;a*b&#125;`)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>div<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>小应用</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
numbers<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//用0填充</span>
<span class="token keyword">var</span> lis <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 列表的兄弟元素需要属性key，赋值i，可以使用表达式key=&#123;i&#125;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">&#123;</span>lis<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>div<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>将表达式作为元素属性（src,className）</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> url <span class="token operator">=</span>
  <span class="token string">"https://img2.baidu.com/it/u=1637591942,1058209050&amp;fm=26&amp;fmt=auto&amp;gp=0.jpg"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>p<span class="token operator">></span>
    <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span> alt<span class="token operator">=</span><span class="token string">""</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="元素的不可变性"><a href="#元素的不可变性" class="headerlink" title="元素的不可变性"></a>元素的不可变性</h2><ul>
<li>虽然 JSX 元素是一个对象，但是该对象中的所有属性不可更改</li>
</ul>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token operator">&lt;</span>div title<span class="token operator">=</span><span class="token string">"asa"</span><span class="token operator">></span><span class="token punctuation">&#123;</span>num<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>props<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>props<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"sac"</span><span class="token punctuation">;</span>
<span class="token comment">// 不能重新设置的原因：Object.freeze了</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>div<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>如果确实需要更改元素的属性，需要重新创建 JSX 元素</li>
</ul>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  num<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token operator">&lt;</span>div title<span class="token operator">=</span><span class="token string">"asa"</span><span class="token operator">></span><span class="token punctuation">&#123;</span>num<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>div<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>DOM 优化：效率很高，只变动 div 的内容</p>
</blockquote>
<h1 id="组件和组件属性"><a href="#组件和组件属性" class="headerlink" title="组件和组件属性"></a>组件和组件属性</h1><p>组件：包含内容、样式和功能的 UI 单元</p>
<h2 id="创建一个组件"><a href="#创建一个组件" class="headerlink" title="创建一个组件"></a>创建一个组件</h2><p><strong>特别注意：组件的名称首字母必须大写</strong><br><strong>​</strong></p>
<p>原因：<br>​</p>
<ol>
<li>函数组件</li>
</ol>
<p>返回一个 React 元素<br>​</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">MyFuncComp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">组件内容</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token punctuation">&#123;</span><span class="token comment">/* &#123;MyFuncComp()&#125; */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
    </span><span class="token punctuation">&#123;</span><span class="token comment">/* 这种调用方式不常用，没有组件结构 */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyFuncComp</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">MyFuncComp</span></span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>类组件 rcc 生成</li>
</ol>
<p>必须继承 React.Component</p>
<p>必须提供 render 函数，用于渲染组件<br>​</p>
<blockquote>
<p>这两种都最终得到一个 React 元素</p>
</blockquote>
<h2 id="组件的属性"><a href="#组件的属性" class="headerlink" title="组件的属性"></a>组件的属性</h2><ol>
<li>对于函数组件，属性会作为一个对象的属性，传递给函数的参数 rfc 生成代码</li>
</ol>
<p>​</p>
<ol start="2">
<li>对于类组件，属性会作为一个对象的属性，传递给构造函数的参数</li>
</ol>
<p>注意：组件的属性，应该使用小驼峰命名法<br>MyClassComp.js</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MyClassComp</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">/**
   * 该方法必须返回React元素
   */</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token comment">// this.props.obj.name = 'zsas' 千万不要这样改</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">姓名：</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">年龄：</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>ui<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">下面是传入的内容</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>ui<span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">类组件的内容，数字：</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>number<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>index.js</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> MyClassComp <span class="token keyword">from</span> <span class="token string">"./MyClassComp"</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token punctuation">&#123;</span><span class="token comment">/* 属性可以传对象，其他属性等等 */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyClassComp</span></span> <span class="token attr-name">number</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">enable</span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyClassComp</span></span>
      <span class="token attr-name">number</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">&#125;</span></span>
      <span class="token attr-name">obj</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>
        name<span class="token operator">:</span> <span class="token string">"成哥"</span><span class="token punctuation">,</span>
        age<span class="token operator">:</span> <span class="token number">19</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
      <span class="token attr-name">ui</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">这是我传递的属性</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token punctuation">&#125;</span></span>
    <span class="token punctuation">/></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>组件无法改变自身的属性</strong>。（只读）</p>
<p>之前学习的 React 元素，本质上，就是一个组件（内置组件） （都只读）</p>
<p>React 中的哲学：数据属于谁，谁才有权力改动（父组件也无权改）</p>
<p><strong>React 中的数据，自顶而下流动</strong><br><strong>​</strong></p>
<h1 id="组件状态"><a href="#组件状态" class="headerlink" title="组件状态"></a>组件状态</h1><p>组件状态：组件可以自行维护的数据</p>
<p>组件状态仅在类组件中有效</p>
<p>状态（state），本质上是类组件的一个属性，是一个对象</p>
<h3 id="状态初始化"><a href="#状态初始化" class="headerlink" title="状态初始化"></a>状态初始化</h3><h3 id="状态的变化"><a href="#状态的变化" class="headerlink" title="状态的变化"></a>状态的变化</h3><p>不能直接改变状态：因为 React 无法监控到状态发生了变化</p>
<p>必须使用 this.setState({})改变状态</p>
<p>一旦调用了 this.setState，会导致当前组件重新渲染</p>
<p><strong>组件中的数据</strong></p>
<ol>
<li>props：该数据是由组件的使用者传递的数据，所有权不属于组件自身，因此组件无法改变该数据</li>
<li>state：该数据是由组件自身创建的，所有权属于组件自身，因此组件有权改变该数据。只有组件自身可以改</li>
</ol>
<h1 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h1><p>在 React 中，组件的事件，本质上就是一个属性</p>
<p>按照之前 React 对组件的约定，由于事件本质上是一个属性，因此也需要使用小驼峰命名法</p>
<p>和原生 DOM 一样，唯一的区别是传入的是小驼峰<br>​</p>
<p>demo</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"点击了！！！"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> btn <span class="token operator">=</span> <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">&#123;</span>handleClick<span class="token punctuation">&#125;</span><span class="token operator">></span>点击<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
传入函数本身，而不是函数调用

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>btn<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>也可以这样写<br>​</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> btn <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
    <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"点击了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
  <span class="token punctuation">></span></span><span class="token plain-text">
    点击
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"点击了"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> btn <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
    <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span>handleClick<span class="token punctuation">&#125;</span></span>
    <span class="token attr-name">onMouseEnter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"鼠标移入了"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
  <span class="token punctuation">></span></span><span class="token plain-text">
    点击
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>btn<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>自定义组件</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> MyComp <span class="token keyword">from</span> <span class="token string">"./MyComp"</span><span class="token punctuation">;</span> <span class="token comment">// 这里要用相对定位，否则会去node_modules里面找</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>如果没有特殊处理，在事件处理函数中，this 指向 undefined</strong></p>
<ol>
<li>使用 bind 函数，绑定 this</li>
<li>使用箭头函数</li>
</ol>
<h1 id="深入认识-setState"><a href="#深入认识-setState" class="headerlink" title="深入认识 setState"></a>深入认识 setState</h1><p>setState，它对状态的改变，<strong>可能</strong>是异步的</p>
<blockquote>
<p>如果改变状态的代码处于某个 HTML 元素的事件中，则其是异步的，否则是同步</p>
</blockquote>
<p>如果遇到某个事件中，需要同步调用多次，需要使用函数的方式得到最新状态</p>
<p>最佳实践：</p>
<ol>
<li>把所有的 setState 当作是异步的</li>
<li>永远不要信任 setState 调用之后的状态</li>
<li>如果要使用改变之后的状态，需要使用回调函数（setState 的第二个参数）</li>
<li>如果新的状态要根据之前的状态进行运算，使用函数的方式改变状态（setState 的第一个函数）</li>
</ol>
<p>React 会对异步的 setState 进行优化，将多次 setState 进行合并（将多次状态改变完成后，再统一对 state 进行改变，然后触发 render）<br>​</p>
<h1 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h1><p>生命周期：组件从诞生到销毁会经历一系列的过程，该过程就叫做生命周期。React 在组件的生命周期中提供了一系列的钩子函数（类似于事件），可以让开发者在函数中注入代码，这些代码会在适当的时候运行。</p>
<p><strong>生命周期仅存在于类组件中，函数组件每次调用都是重新运行函数，旧的组件即刻被销毁</strong></p>
<h2 id="旧版生命周期"><a href="#旧版生命周期" class="headerlink" title="旧版生命周期"></a>旧版生命周期</h2><p>React &lt; 16.0.0</p>
<ol>
<li>constructor<ol>
<li>同一个组件对象只会创建一次</li>
<li>不能在第一次挂载到页面之前，调用 setState，为了避免问题，构造函数中严禁使用 setState</li>
</ol>
</li>
</ol>
<ul>
<li>因为 setState 会导致重新渲染，在挂载之前，没必要重新渲染</li>
</ul>
<ol start="2">
<li><p>componentWillMount</p>
<ol>
<li>正常情况下，和构造函数一样，它只会运行一次</li>
<li>可以使用 setState，但是为了避免 bug，不允许使用，因为在某些特殊情况下，该函数可能被调用多次</li>
</ol>
</li>
<li><p><strong>render</strong></p>
<ol>
<li>返回一个虚拟 DOM，会被挂载到虚拟 DOM 树中，最终渲染到页面的真实 DOM 中</li>
<li>render 可能不只运行一次，只要需要重新渲染，就会重新运行</li>
<li>严禁使用 setState，因为可能会导致无限递归渲染</li>
</ol>
</li>
<li><p><strong>componentDidMount</strong></p>
<ol>
<li>只会执行一次</li>
<li>可以使用 setState</li>
<li>通常情况下，会将网络请求、启动计时器等一开始需要的操作，书写到该函数中</li>
</ol>
</li>
<li><p>组件进入活跃状态</p>
</li>
<li><p>componentWillReceiveProps</p>
<ol>
<li>即将接收新的属性值</li>
<li>参数为新的属性对象</li>
<li>该函数可能会导致一些 bug，所以不推荐使用</li>
</ol>
</li>
<li><p><strong>shouldComponentUpdate</strong></p>
<ol>
<li>指示 React 是否要重新渲染该组件，通过返回 true 和 false 来指定</li>
<li>默认情况下，会直接返回 true</li>
<li>属性直接被赋值了，不一定要值变化</li>
</ol>
</li>
<li><p>componentWillUpdate</p>
<ol>
<li>组件即将被重新渲染</li>
</ol>
</li>
<li><p>componentDidUpdate</p>
<ol>
<li>往往在该函数中使用 dom 操作，改变元素</li>
</ol>
</li>
<li><p><strong>componentWillUnmount</strong></p>
</li>
<li><p>通常在该函数中销毁一些组件依赖的资源，比如计时器</p>
</li>
</ol>
<h2 id="新版生命周期"><a href="#新版生命周期" class="headerlink" title="新版生命周期"></a>新版生命周期</h2><p>React &gt;= 16.0.0</p>
<p>React 官方认为，某个数据的来源必须是单一的。要么来自属性，要么来自状态。</p>
<ol>
<li><p>getDerivedStateFromProps</p>
<ol>
<li>通过参数可以获取新的属性和状态</li>
<li>该函数是静态的</li>
<li>该函数的返回值会覆盖掉组件状态</li>
<li>该函数几乎是没有什么用</li>
</ol>
</li>
<li><p>getSnapshotBeforeUpdate</p>
<ol>
<li>运行时间：真实的 DOM 构建完成，但还未实际渲染到页面中。</li>
<li>在该函数中，通常用于实现一些附加的 dom 操作</li>
<li>该函数的返回值，会作为 componentDidUpdate 的第三个参数</li>
<li>配合 componentDidUpdate 使用</li>
</ol>
</li>
</ol>
<h1 id="传递元素内容"><a href="#传递元素内容" class="headerlink" title="传递元素内容"></a>传递元素内容</h1><p>内置组件：div、h1、p</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>asdfafasfafasdfasdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>index.js</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx">ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">New</span></span> <span class="token attr-name">html</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">sss</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">&#125;</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>new.js</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>props<span class="token punctuation">.</span>html<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>如果给自定义组件传递元素内容，则 React 会将元素内容作为 children 属性传递过去。<br>所以有了另一种写法：<br>index.js</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx">ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">New</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">sss</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">New</span></span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>new.js</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>comp<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>props<span class="token punctuation">.</span>children<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h1><p>受控组件和非受控组件</p>
<p>受控组件：组件的使用者，有能力完全控制该组件的行为和内容。通常情况下，受控组件往往没有自身的状态，其内容完全收到属性的控制。</p>
<p>非受控组件：组件的使用者，没有能力控制该组件的行为和内容，组件的行为和内容完全自行控制。</p>
<p><strong>表单组件，默认情况下是非受控组件，一旦设置了表单组件的 value 属性，则其变为受控组件(单选和多选框需要设置 checked)</strong><br>​</p>
<h1 id="属性默认值-和-类型检查"><a href="#属性默认值-和-类型检查" class="headerlink" title="属性默认值 和 类型检查"></a>属性默认值 和 类型检查</h1><h2 id="属性默认值"><a href="#属性默认值" class="headerlink" title="属性默认值"></a>属性默认值</h2><p>之前是用混入解决的：Object.assign({},defaultProps,props)</p>
<p>通过一个静态属性<code>defaultProps</code>告知 react 属性默认值<br>函数本身的属性：函数也是对象</p>
<p>混合完成时间：</p>
<ol>
<li>函数组件：调用函数之前就完成了</li>
<li>类组件：运行构造函数之前完成</li>
</ol>
<h2 id="属性类型检查"><a href="#属性类型检查" class="headerlink" title="属性类型检查"></a>属性类型检查</h2><p>使用库：<code>prop-types</code></p>
<p>对组件使用静态属性<code>propTypes</code>告知 react 如何检查属性<br>如果不按照类型传递属性的话，报警告，不影响代码执行。（只在开发阶段报警告）<br>可以不传递，但是一旦传递，必须正确</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">PropTypes<span class="token punctuation">.</span>any：<span class="token comment">//任意类型  通常用在列出所有属性，方便阅读；可以设置必填</span>
PropTypes<span class="token punctuation">.</span>array：<span class="token comment">//数组类型</span>
PropTypes<span class="token punctuation">.</span>bool：<span class="token comment">//布尔类型</span>
PropTypes<span class="token punctuation">.</span>func：<span class="token comment">//函数类型  事件</span>
PropTypes<span class="token punctuation">.</span>number：<span class="token comment">//数字类型</span>
PropTypes<span class="token punctuation">.</span>object：<span class="token comment">//对象类型</span>
PropTypes<span class="token punctuation">.</span>string：<span class="token comment">//字符串类型</span>
PropTypes<span class="token punctuation">.</span>symbol：<span class="token comment">//符号类型</span>

PropTypes<span class="token punctuation">.</span>node：
<span class="token comment">//任何可以被渲染的内容，字符串、数字、React元素。如果传递null undefined，没有报错，因为没有进行非空验证</span>
PropTypes<span class="token punctuation">.</span>element：<span class="token comment">//react元素</span>
PropTypes<span class="token punctuation">.</span>elementType：<span class="token comment">//react元素类型</span>
PropTypes<span class="token punctuation">.</span><span class="token function">instanceOf</span><span class="token punctuation">(</span>构造函数<span class="token punctuation">)</span>：<span class="token comment">//必须是指定构造函数的实例</span>
PropTypes<span class="token punctuation">.</span><span class="token function">oneOf</span><span class="token punctuation">(</span><span class="token punctuation">[</span>xxx<span class="token punctuation">,</span> xxx<span class="token punctuation">]</span><span class="token punctuation">)</span>：<span class="token comment">//枚举</span>
PropTypes<span class="token punctuation">.</span><span class="token function">oneOfType</span><span class="token punctuation">(</span><span class="token punctuation">[</span>xxx<span class="token punctuation">,</span> xxx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//属性类型必须是数组中的其中一个</span>
PropTypes<span class="token punctuation">.</span><span class="token function">arrayOf</span><span class="token punctuation">(</span>PropTypes<span class="token punctuation">.</span><span class="token constant">XXX</span><span class="token punctuation">)</span>：<span class="token comment">//必须是某一类型组成的数组</span>
PropTypes<span class="token punctuation">.</span><span class="token function">objectOf</span><span class="token punctuation">(</span>PropTypes<span class="token punctuation">.</span><span class="token constant">XXX</span><span class="token punctuation">)</span>：<span class="token comment">//对象由某一类型的值组成</span>
PropTypes<span class="token punctuation">.</span><span class="token function">shape</span><span class="token punctuation">(</span>对象<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token comment">//属性必须是对象，并且满足指定的对象要求</span>
PropTypes<span class="token punctuation">.</span><span class="token function">exact</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token operator">...</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>：<span class="token comment">//和shape一样，只是exact要求对象必须精确匹配传递的数据</span>

<span class="token comment">//自定义属性检查，如果有错误，返回错误对象即可</span>
<span class="token function-variable function">属性</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> propName<span class="token punctuation">,</span> componentName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
   <span class="token comment">//...</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="HOC-高阶组件"><a href="#HOC-高阶组件" class="headerlink" title="HOC 高阶组件"></a>HOC 高阶组件</h1><p>HOF：Higher-Order Function, 高阶函数，以函数作为参数，并返回一个函数<br>HOC: Higher-Order Component, 高阶组件，以组件作为参数，并返回一个组件</p>
<p>通常，可以利用 HOC 实现横切关注点。</p>
<blockquote>
<p>举例：20 个组件，每个组件在创建组件和销毁组件时，需要作日志记录<br>20 个组件，它们需要显示一些内容，得到的数据结构完全一致</p>
</blockquote>
<p><strong>注意</strong></p>
<ol>
<li>不要在 render 中使用高阶组件。在 render 内部的话重新创建，失去状态，浪费效率。在 render 外部则使用的是同一个类。</li>
<li>不要在高阶组件内部更改传入的组件（防止混乱）</li>
</ol>
<h1 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h1><p>reference: 引用</p>
<p>场景：希望直接使用 dom 元素中的某个方法，或者希望直接使用自定义组件中的某个方法</p>
<ol>
<li>ref 作用于内置的 html 组件，得到的将是真实的 dom 对象</li>
<li>ref 作用于类组件，得到的将是类的实例</li>
<li>ref 不能作用于函数组件</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 类组件
 */</span>
<span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"调用了A组件的方法"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">组件A</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/**
 * 内置html组件
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Comp</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// console.log(this)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>refs<span class="token punctuation">.</span>txt<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>refs<span class="token punctuation">.</span>compA<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>txt<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">A</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>compA<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">聚焦</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>以上：ref 不再推荐使用字符串赋值，字符串赋值的方式将来可能会被移出。（效率低）</p>
<p>目前，ref 推荐使用对象或者是函数</p>
<p><strong>对象</strong></p>
<p>通过 React.createRef 函数创建</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Comp</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* 
            方法2：这样创建对象也可以
          this.txt = &#123;
            current: null
        &#125; */</span>
    <span class="token comment">// 方法1 createRef</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>txt <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>txt<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&#123;current: null&#125;</span>
    <span class="token comment">// 第一次渲染的时候会给current赋值</span>
    <span class="token comment">// current: input</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// console.log(this)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>txt<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>txt<span class="token punctuation">&#125;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>txt<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">聚焦</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>函数</strong></p>
<p>函数的调用时间：</p>
<ol>
<li>componentDidMount 的时候会调用该函数<ol>
<li>在 componentDidMount 事件中可以使用 ref</li>
</ol>
</li>
<li>如果 ref 的值发生了变动（旧的函数被新的函数替代），分别调用旧的函数以及新的函数，时间点出现在 componentDidUpdate 之前<ol>
<li>旧的函数被调用时，传递 null</li>
<li>新的函数被调用时，传递对象</li>
</ol>
</li>
<li>如果 ref 所在的组件被卸载，会调用函数</li>
</ol>
<p><strong>谨慎使用 ref</strong></p>
<p>能够使用属性和状态进行控制，就不要使用 ref。</p>
<ol>
<li>调用真实的 DOM 对象中的方法</li>
<li>某个时候需要调用类组件的方法</li>
</ol>
<h1 id="Ref-转发"><a href="#Ref-转发" class="headerlink" title="Ref 转发"></a>Ref 转发</h1><p>forwardRef</p>
<p>forwardRef 方法：</p>
<ol>
<li>参数，传递的是函数组件，不能是类组件，并且，函数组件需要有第二个参数来得到 ref</li>
<li>返回值，返回一个新的组件</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// console.log(props, ref)</span>
  <span class="token comment">/*  return &lt;h1>组件A
         &lt;span>&#123;props.word&#125;&lt;/span>
     &lt;/h1> */</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span>ref<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      组件A
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>props<span class="token punctuation">.</span>word<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// 传递函数组件A，得到一个新组件NewA</span>
<span class="token keyword">const</span> NewA <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//一旦经过了这个操作，ref代表的就由函数组件自己控制了</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  ARef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// componentDidMount() &#123;</span>
  <span class="token comment">//     console.log(this.ARef)//null  啥都得不到，让我自己去控制。依靠第二个参数了</span>
  <span class="token comment">// &#125;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">&#123;</span><span class="token comment">/* &lt;A ref=&#123;this.ARef&#125; /> */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token punctuation">&#123;</span><span class="token comment">/* 木得：this.ARef.current:h1 */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">NewA</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>ARef<span class="token punctuation">&#125;</span></span> <span class="token attr-name">word</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>类组件咋办呢？<br>方法 1</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * ref:就是一个对象
 * ref:&#123;
 *  current:null
 * &#125;
 */</span>
<span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>ref1<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        组件A
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>words<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  ARef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ARef<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">A</span></span> <span class="token attr-name">ref1</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>ARef<span class="token punctuation">&#125;</span></span> <span class="token attr-name">words</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>方法 2</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>abc<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        组件A
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>words<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/**
 * 函数包装一下
 */</span>
<span class="token keyword">const</span> NewA <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">A</span></span> <span class="token spread"><span class="token punctuation">&#123;</span><span class="token operator">...</span>props<span class="token punctuation">&#125;</span></span> <span class="token attr-name">abc</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span>ref<span class="token punctuation">&#125;</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  ARef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ARef<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">NewA</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>ARef<span class="token punctuation">&#125;</span></span> <span class="token attr-name">words</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>高阶组件</strong></p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> <span class="token constant">A</span> <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./components/Comp"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> withLog <span class="token keyword">from</span> <span class="token string">"./HOC/withLog"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> AComp <span class="token operator">=</span> <span class="token function">withLog</span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  myRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//logwrapper</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">&#123;</span><span class="token comment">/* ref:代表了日志记录了，但是我想代表A */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AComp</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">&#125;</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>改装 withLog.js</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 高阶组件
 * @param &#123;*&#125; comp 组件
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">withLog</span><span class="token punctuation">(</span><span class="token parameter">Comp</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">class</span> <span class="token class-name">LogWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">日志：组件</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>Comp<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">被创建了！</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">日志：组件</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>Comp<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">被销毁了！</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token comment">//正常的属性</span>
      <span class="token comment">//forwardRef代表要转发的ref  &#123;current:null&#125;</span>
      <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> forwardRef<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>Comp ref<span class="token operator">=</span><span class="token punctuation">&#123;</span>forwardRef<span class="token punctuation">&#125;</span> <span class="token punctuation">&#123;</span><span class="token operator">...</span>rest<span class="token punctuation">&#125;</span> <span class="token operator">/</span><span class="token operator">></span> 最终，current指向他
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>LogWrapper <span class="token punctuation">&#123;</span><span class="token operator">...</span>props<span class="token punctuation">&#125;</span> forwardRef<span class="token operator">=</span><span class="token punctuation">&#123;</span>ref<span class="token punctuation">&#125;</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id><a href="#" class="headerlink" title></a></h1><h1 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h1><p>上下文：Context，表示做某一些事情的环境</p>
<p>React 中的上下文特点：</p>
<ol>
<li>当某个组件创建了上下文后，上下文中的数据，会被所有后代组件共享</li>
<li>如果某个组件依赖了上下文，会导致该组件不再纯粹（纯粹指的是外部数据仅来源于属性 props）</li>
<li>一般情况下，用于第三方组件（通用组件）</li>
</ol>
<h2 id="旧的-API"><a href="#旧的-API" class="headerlink" title="旧的 API"></a>旧的 API</h2><blockquote>
<p><strong>创建上下文</strong></p>
</blockquote>
<p>只有类组件才可以创建上下文</p>
<ol>
<li>给类组件书写静态属性 <strong>childContextTypes</strong>，使用该属性对上下文中的数据类型进行约束</li>
<li>添加实例方法 <strong>getChildContext</strong>，该方法返回的对象，即为上下文中的数据，该数据必须满足类型约束，该方法会在每次 render 之后运行。</li>
</ol>
<blockquote>
<p><strong>使用上下文中的数据</strong></p>
</blockquote>
<p>要求：如果要使用上下文中的数据，组件必须有一个静态属性 <strong>contextTypes</strong>，该属性描述了需要获取的上下文中的数据类型。</p>
<ol>
<li>可以在组件的构造函数中，通过第二个参数，获取上下文数据。但是由于构造函数只会运行一次，后面上下文数据改变了，不会更新</li>
<li><strong>从组件的 context 属性中获取</strong></li>
<li>在函数组件中，通过第二个参数，获取上下文数据。数据并不会流动异常，只是调用了父组件的函数而已<blockquote>
<p><strong>创建上下文只能是类组件，获取上下文可以是类组件或函数组件</strong></p>
</blockquote>
</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> types <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  a<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
  b<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">ChildA</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 在函数组件中，通过第二个参数，获取上下文数据</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildA</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
        a</span><span class="token punctuation">&#123;</span>context<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text"> ; b</span><span class="token punctuation">&#123;</span>context<span class="token punctuation">.</span>b<span class="token punctuation">&#125;</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildB</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
ChildA<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> types<span class="token punctuation">;</span> <span class="token comment">//前提条件contextTypes</span>

<span class="token keyword">class</span> <span class="token class-name">ChildB</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> contextTypes <span class="token operator">=</span> types<span class="token punctuation">;</span>
  <span class="token comment">// 方法2：从组件的context属性中获取</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token comment">// 如果不写构造函数，会自动运行super</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
        ChildB 来自于上下文的数据 a:</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text">, b:</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>b<span class="token punctuation">&#125;</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">OldContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">/**
   * 约束上下文中数据的类型
   */</span>
  <span class="token keyword">static</span> childContextTypes <span class="token operator">=</span> types<span class="token punctuation">;</span>
  <span class="token comment">/**
   *
   * @returns 得到上下文数据
   */</span>
  <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"获取上下文中的数据"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
      a<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
      b<span class="token operator">:</span> <span class="token string">"aaa"</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildA</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p><strong>上下文的数据变化</strong></p>
</blockquote>
<p>上下文中的数据不可以直接变化，最终都是通过状态改变<br>​</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">OldContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">/**
   * 约束上下文中数据的类型
   */</span>
  <span class="token keyword">static</span> childContextTypes <span class="token operator">=</span> types<span class="token punctuation">;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    a<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token string">"abc"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   *
   * @returns 得到上下文数据
   */</span>
  <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"获取新的上下文"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
      a<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token punctuation">,</span> <span class="token comment">//来自状态了</span>
      b<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>b<span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildA</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
              <span class="token comment">//每次改变状态都会重新运行getChildContext。会导致重新渲染</span>
              a<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          a+1
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在上下文中加入一个处理函数，<strong>可以用于后代组件更改上下文的数据</strong><br>​</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> types <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  a<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
  b<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  onChangeA<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>func<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">ChildA</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildA</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
        a</span><span class="token punctuation">&#123;</span>context<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text"> ; b</span><span class="token punctuation">&#123;</span>context<span class="token punctuation">.</span>b<span class="token punctuation">&#125;</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildB</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
ChildA<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> types<span class="token punctuation">;</span> <span class="token comment">//前提条件contextTypes</span>

<span class="token keyword">class</span> <span class="token class-name">ChildB</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> contextTypes <span class="token operator">=</span> types<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
        ChildB 来自于上下文的数据 a:</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text">, b:</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>b<span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">onChangeA</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          子组件按钮a+2
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">OldContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> childContextTypes <span class="token operator">=</span> types<span class="token punctuation">;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    a<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token string">"abc"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
      a<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token punctuation">,</span>
      b<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>b<span class="token punctuation">,</span>
      <span class="token function-variable function">onChangeA</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">newA</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//这里要用箭头函数，否则报错</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
          a<span class="token operator">:</span> newA<span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildA</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
              a<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          a+1
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="新版-API"><a href="#新版-API" class="headerlink" title="新版 API"></a>新版 API</h2><p>旧版 API 存在严重的效率问题，并且容易导致滥用</p>
<p><strong>创建上下文</strong></p>
<p>上下文是一个独立于组件的对象，该对象通过 React.createContext(默认值)创建</p>
<p>返回的是一个包含两个属性的对象</p>
<ol>
<li>Provider 属性：生产者。一个组件，该组件会创建一个上下文，该组件有一个 value 属性，通过该属性，可以为其数据赋值<ol>
<li>同一个 Provider，不要用到多个组件中，如果需要在其他组件中使用该数据，应该考虑将数据提升到更高的层次</li>
</ol>
</li>
</ol>
<blockquote>
<p>使用类组件获取上下文</p>
</blockquote>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ctx <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//里面可以填默认值</span>

<span class="token comment">// console.log(ctx)</span>

<span class="token keyword">function</span> <span class="token function">ChildA</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildA</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildB</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">ChildB</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> ctx<span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        ChildB,来自上下文的数据：a:</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text">,b:</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>b<span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">changeA</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          后代组件的按钮，点击a+2
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">NewContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token string">"abc"</span><span class="token punctuation">,</span>
    <span class="token function-variable function">changeA</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">newA</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        a<span class="token operator">:</span> newA<span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token comment">/* render() &#123;
        const Provider = ctx.Provider;//可以把ctx.Provider直接当组件用&lt;ctx.Provider>&lt;/ctx.Provider>
        return (
            &lt;Provider value=&#123;this.state&#125;>
                &lt;div>&lt;/div>
            &lt;/Provider>
        )
    &#125; */</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildA</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                a<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
              <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
          <span class="token punctuation">></span></span><span class="token plain-text">
            父组件的按钮a+1
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx.Provider</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>Consumer 属性：后续讲解</li>
</ol>
<p><strong>使用上下文中的数据</strong></p>
<ol>
<li>在类组件中，直接使用 this.context 获取上下文数据<ol>
<li>要求：必须拥有静态属性 contextType , 应赋值为创建的上下文对象</li>
</ol>
</li>
<li>在函数组件中，需要使用 Consumer 来获取上下文数据<ol>
<li>Consumer 是一个组件</li>
<li>它的子节点，是一个函数（它的 props.children 需要传递一个函数）</li>
<li>不需要写静态属性<blockquote>
<p>使用函数组件获取上下文</p>
</blockquote>
</li>
</ol>
</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">const</span> ctx <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">ChildA</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildA</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">&#123;</span><span class="token comment">/* 
                写法1
               &lt;ctx.Consumer>
                  这里已经明确使用哪个上下文了，不用写静态属性了
                    &#123;value => &lt;>&#123;value.a&#125;,&#123;value.b&#125;&lt;/>&#125;
                &lt;/ctx.Consumer> */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token punctuation">&#123;</span><span class="token comment">/* 写法2 */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx.Consumer</span>
          <span class="token attr-name">children</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token punctuation">&#123;</span>value<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text">,</span><span class="token punctuation">&#123;</span>value<span class="token punctuation">.</span>b<span class="token punctuation">&#125;</span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
          <span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx.Consumer</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildB</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>类组件中，也可以通过这个方法获取。比较常用，不需要 contextType 了</p>
</blockquote>
<blockquote>
<p>创建多个，互不干扰</p>
</blockquote>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ctx1 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ctx2 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">ChildA</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx2.Provider</span>
      <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>
        a<span class="token operator">:</span> <span class="token number">789</span><span class="token punctuation">,</span>
        c<span class="token operator">:</span> <span class="token string">"hello"</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildA</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx1.Consumer</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
                </span><span class="token punctuation">&#123;</span>value<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text">，</span><span class="token punctuation">&#123;</span>value<span class="token punctuation">.</span>b<span class="token punctuation">&#125;</span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
            <span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx1.Consumer</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildB</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx2.Provider</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">ChildB</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx1.Consumer</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
              ChildB，来自于上下文的数据：a: </span><span class="token punctuation">&#123;</span>value<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text">, b:</span><span class="token punctuation">&#123;</span>value<span class="token punctuation">.</span>b<span class="token punctuation">&#125;</span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
                <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
                  value<span class="token punctuation">.</span><span class="token function">changeA</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
              <span class="token punctuation">></span></span><span class="token plain-text">
                后代组件的按钮，点击a+2
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx2.Consumer</span><span class="token punctuation">></span></span><span class="token plain-text">
                </span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
                    来自于ctx2的数据： a: </span><span class="token punctuation">&#123;</span>val<span class="token punctuation">.</span>a<span class="token punctuation">&#125;</span><span class="token plain-text">， c:</span><span class="token punctuation">&#123;</span>val<span class="token punctuation">.</span>c<span class="token punctuation">&#125;</span><span class="token plain-text">
                  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
                <span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx2.Consumer</span><span class="token punctuation">></span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx1.Consumer</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">NewContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    a<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token string">"abc"</span><span class="token punctuation">,</span>
    <span class="token function-variable function">changeA</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">newA</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        a<span class="token operator">:</span> newA<span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx1.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildA</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">

          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
            <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                a<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
              <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
          <span class="token punctuation">></span></span><span class="token plain-text">
            父组件的按钮，a加1
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx1.Provider</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>注意细节</strong></p>
<p>如果，上下文提供者（Context.Provider）中的 value 属性发生变化(Object.is 比较)，会导致该上下文提供的所有后代元素全部重新渲染，无论该子元素是否有优化（无论 shouldComponentUpdate 函数返回什么结果）<br>​</p>
<p>上下文的应用场景</p>
<p>编写一套组件（有多个组件），这些组件之间需要相互配合才能最终完成功能</p>
<p>比如，我们要开发一套表单组件，使用方式如下</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token parameter">datas</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取表单中的所有数据（对象）</span>
        <span class="token comment">/*
                &#123;
                    loginId:xxxx,
                    loginPwd:xxxx
                &#125;
            */</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        账号： </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form.Input</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginId<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        密码： </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form.Input</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginPwd<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form.Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">提交</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Form.Button</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Form</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="PureComponent"><a href="#PureComponent" class="headerlink" title="PureComponent"></a>PureComponent</h1><p>纯组件：用于避免不必要的渲染（运行 render），从而提高效率</p>
<p>优化：如果一个组件的属性和状态，都没有发生变化，该组件的重新渲染是没有必要的<br>​</p>
<p>PureComponent 是一个组件，如果某个组件继承自该组件，则该组件的 shouldComponentUpdate 会进行优化，对属性和状态进行钱比较。相等就不会重新渲染<br>​</p>
<p>注意场景：改动之前的数组，地址不会变化，浅比较会认为没发生变化。所以尽量不改动原数组，应该创建新数组</p>
<ol>
<li>为了效率，尽量用纯组件</li>
<li>不要改变之前的状态，永远是创建新的状态覆盖之前的状态（Immutable 不可变对象）</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// 加入要改变对象的某个值，不要改变原对象</span>
obj<span class="token operator">:</span><span class="token punctuation">&#123;</span>
	<span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>obj<span class="token punctuation">,</span>
    b<span class="token operator">:</span><span class="token number">500</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// 或者</span>

Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>obj<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>b<span class="token operator">:</span><span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>有一个第三方库，Immutable.js 专门用于制作不可变对象</li>
</ol>
<p>函数组件没有生命周期，每次需要重新调用函数，要防止重新调用函数，使用 React.memo 函数制作纯组件</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">default</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span>Task<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//高阶组件  套了一层类组件</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>实现原理<br>​</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token parameter">FuncComp</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">Memo</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">&#123;</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token comment">// return &lt;FuncComp  &#123;...this.props&#125;/></span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span><span class="token function">FuncComp</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="render-props"><a href="#render-props" class="headerlink" title="render props"></a>render props</h1><p>有时候，某些组件的各种功能及其处理逻辑几乎完全相同，只是显示的界面不一样，建议下面的方式认选其一来解决重复代码的问题（横切关注点）</p>
<ol>
<li>render props<ol>
<li>某个组件，需要某个属性</li>
<li>该属性是一个函数，函数的返回值用于渲染</li>
<li>函数的参数会传递为需要的数据</li>
<li>注意纯组件的属性（尽量避免每次传递的 render props 的地址不一致，应该把函数提出来）</li>
<li>通常该属性的名字叫做 render</li>
</ol>
</li>
<li>HOC</li>
</ol>
<h1 id="Portals"><a href="#Portals" class="headerlink" title="Portals"></a>Portals</h1><p>插槽：将一个 React 元素渲染到指定的 DOM 容器中</p>
<p>ReactDOM.createPortal(React 元素, 真实的 DOM 容器)，该函数返回一个 React 元素<br>​</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">ChildA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createPortal</span><span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>child-a<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildA</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildB</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".modal"</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">ChildB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>child-b<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildB</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">App</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildA</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现象：真实的 DOM 结构变成了代码那样，但是组件结构变化。说明 React 虚拟 DOM 树和真实 DOM 树可以有差异</p>
<p><strong>注意事件冒泡</strong></p>
<ol>
<li>React 中的事件是包装过的</li>
<li>它的事件冒泡是根据虚拟 DOM 树（组件结构）来冒泡的，与真实的 DOM 树无关。</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">ChildA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createPortal</span><span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>child-a<span class="token punctuation">"</span></span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>
        marginTop<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildA</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildB</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".modal"</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">ChildB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>child-b<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">ChildB</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span>
      <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"App被点击了"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">App</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ChildA</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="错误边界"><a href="#错误边界" class="headerlink" title="错误边界"></a>错误边界</h1><p>默认情况下，若一个组件在<strong>渲染期间</strong>（render）发生错误，会导致整个组件树全部被卸载</p>
<p>错误边界：是一个组件，该组件会捕获到渲染期间（render）子组件发生的错误，并有能力阻止错误继续传播</p>
<p><strong>让某个组件捕获错误</strong></p>
<ol>
<li>编写生命周期函数 getDerivedStateFromError<ol>
<li>静态函数</li>
<li>运行时间点：渲染子组件的过程中，发生错误之后，在更新页面之前</li>
<li><strong>注意：只有子组件发生错误，才会运行该函数。自己发生错误处理不了</strong></li>
<li>该函数返回一个对象，React 会将该对象的属性覆盖掉当前组件的 state</li>
<li>参数：错误对象</li>
<li>通常，该函数用于改变状态</li>
</ol>
</li>
<li>编写生命周期函数 componentDidCatch<ol>
<li>实例方法</li>
<li>运行时间点：渲染子组件的过程中，发生错误，更新页面之后，由于其运行时间点比较靠后，因此不太会在该函数中改变状态</li>
<li>通常，该函数用于记录错误消息</li>
</ol>
</li>
</ol>
<p><strong>细节</strong></p>
<p>某些错误，错误边界组件无法捕获</p>
<ol>
<li>自身的错误</li>
<li>异步的错误</li>
<li>事件中的错误</li>
</ol>
<p>这些错误，需要用 try catch 处理<br>​</p>
<p>总结：仅处理渲染子组件期间的同步错误<br>​</p>
<h1 id="React-中的事件"><a href="#React-中的事件" class="headerlink" title="React 中的事件"></a>React 中的事件</h1><p>这里的事件：React 内置的 DOM 组件中的事件</p>
<ol>
<li>给 document 注册事件</li>
<li>几乎所有的元素的事件处理，均在 document 的事件中处理<ol>
<li>一些不冒泡的事件，是直接在元素上监听</li>
<li>一些 document 上面没有的事件，直接在元素上监听</li>
</ol>
</li>
<li>在 document 的事件处理，React 会根据虚拟 DOM 树的完成事件函数的调用</li>
<li>React 的事件参数，并非真实的 DOM 事件参数，是 React 合成的一个对象，该对象类似于真实 DOM 的事件参数<ol>
<li>stopPropagation，阻止事件在虚拟 DOM 树中冒泡</li>
<li>nativeEvent，可以得到真实的 DOM 事件对象</li>
<li>为了提高执行效率，React 使用事件对象池来处理事件对象</li>
</ol>
</li>
</ol>
<p><strong>注意事项</strong></p>
<ol>
<li>如果给真实的 DOM 注册事件，阻止了事件冒泡，则会导致 react 的相应事件无法触发</li>
<li>如果给真实的 DOM 注册事件，事件会先于 React 事件运行</li>
<li>通过 React 的事件中阻止事件冒泡，无法阻止真实的 DOM 事件冒泡</li>
<li>可以通过 nativeEvent.stopImmediatePropagation()，阻止 document 上剩余事件的执行</li>
<li>在事件处理程序中，不要异步的使用事件对象，如果一定要使用，需要调用 persist 函数</li>
</ol>
<h1 id="渲染原理"><a href="#渲染原理" class="headerlink" title="渲染原理"></a>渲染原理</h1><p>渲染：生成用于显示的对象，以及将这些对象形成真实的 DOM 对象</p>
<ul>
<li>React 元素：React Element，通过 React.createElement 创建（语法糖：JSX）<ul>
<li>例如：</li>
<li><code>&lt;div&gt;&lt;h1&gt;标题&lt;/h1&gt;&lt;/div&gt;</code></li>
<li><code>&lt;App /&gt;</code></li>
</ul>
</li>
<li>React 节点：专门用于渲染到 UI 界面的对象，React 会通过 React 元素，创建 React 节点，ReactDOM 一定是通过 React 节点来进行渲染的</li>
<li>节点类型：<ul>
<li>React DOM 节点：创建该节点的 React 元素类型是一个字符串</li>
<li>React 组件节点：创建该节点的 React 元素类型是一个函数或是一个类</li>
<li>React 文本节点：由字符串、数字创建的</li>
<li>React 空节点：由 null、undefined、false、true</li>
<li>React 数组节点：该节点由一个数组创建</li>
</ul>
</li>
<li>真实 DOM：通过 document.createElement 创建的 dom 元素</li>
</ul>
<h2 id="首次渲染-新节点渲染"><a href="#首次渲染-新节点渲染" class="headerlink" title="首次渲染(新节点渲染)"></a>首次渲染(新节点渲染)</h2><ol>
<li>通过参数的值创建节点</li>
<li>根据不同的节点，做不同的事情<ol>
<li>文本节点：通过 document.createTextNode 创建真实的文本节点</li>
<li>空节点：什么都不做，但是存在会占位</li>
<li>数组节点：遍历数组，将数组每一项递归创建节点（回到第 1 步进行反复操作，直到遍历结束）</li>
<li>DOM 节点：通过 document.createElement 创建真实的 DOM 对象，然后立即设置该真实 DOM 元素的各种属性，然后遍历对应 React 元素的 children 属性，递归操作（回到第 1 步进行反复操作，直到遍历结束）</li>
<li>组件节点<ol>
<li>函数组件：调用函数(该函数必须返回一个可以生成节点的内容)，将该函数的返回结果递归生成节点（回到第 1 步进行反复操作，直到遍历结束）</li>
<li>类组件：<ol>
<li>创建该类的实例</li>
<li>立即调用对象的生命周期方法：static getDerivedStateFromProps</li>
<li>运行该对象的 render 方法，拿到节点对象（将该节点递归操作，回到第 1 步进行反复操作）</li>
<li>将该组件的 componentDidMount 加入到执行队列（先进先出，先进先执行），当整个虚拟 DOM 树全部构建完毕，并且将真实的 DOM 对象加入到容器中后，执行该队列</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>生成出虚拟 DOM 树之后，将该树保存起来，以便后续使用</li>
<li>将之前生成的真实的 DOM 对象，加入到容器中。</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"assaf"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>h1<span class="token operator">></span>
      标题
      <span class="token punctuation">&#123;</span><span class="token punctuation">[</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>p<span class="token operator">></span>段落<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>
    <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token keyword">undefined</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Comp1</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Comp1 <span class="token punctuation">&#123;</span>props<span class="token punctuation">.</span>n<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">></span>
      <span class="token operator">&lt;</span>Comp1 n<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">5</span><span class="token punctuation">&#125;</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>以上代码生成的虚拟 DOM 树：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/758572/1629548684500-91c2f415-e48f-4d10-953a-8bbe1bf3a152.png#clientId=u0d2a7992-0ebb-4&from=ui&height=406&id=u3d2813e8&margin=%5Bobject%20Object%5D&name=2019-07-25-14-49-53.png&originHeight=640&originWidth=677&originalType=binary&ratio=1&size=24381&status=done&style=none&taskId=u35d02cd9-f34d-4062-ba5b-f1c9233fe12&width=429" alt="2019-07-25-14-49-53.png"></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Comp1</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Comp1<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span>Comp1 <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>以上代码生成的虚拟 DOM 树：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/758572/1629548699510-5e8ff603-d44e-4306-a47a-0e8e0569c561.png#clientId=u0d2a7992-0ebb-4&from=ui&height=400&id=u96148519&margin=%5Bobject%20Object%5D&name=2019-07-25-14-56-35.png&originHeight=695&originWidth=578&originalType=binary&ratio=1&size=25238&status=done&style=none&taskId=ubff2dbd3-a5b9-422a-9260-386c518f750&width=333" alt="2019-07-25-14-56-35.png"><br>面试题：<br>​</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Comp1</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"Comp1 constructor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">prop<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"Comp1 getDerivedStateFromProps"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"Comp1 render"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Comp</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">appp</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 先创建实例，创建实例对象（运行constructor）</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"App constructor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">prop<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"App getDerivedStateFromProps"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"App render"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">&#123;</span><span class="token comment">/* 构建此节点，创建Comp1对象 */</span><span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp1</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>面试题 2</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Comp1</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"Comp componentDidMount"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Comp</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">appp</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"App componentDidMount"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 先b后a原因（子组件先运行，在运行父组件）</span>
    <span class="token comment">// 先运行render，要进行递归操作（第三步：找类组件，找到Comp1，运行render。Comp1先加入队列）</span>
    <span class="token comment">// 处理完App的第三步，在运行第四布（加入队列）</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp1</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>面试题 3:div 包住两个 App，再问执行顺序</p>
<pre class="line-numbers language-none"><code class="language-none">队列:Comp1 App  Comp1 App
左边执行完在执行右边而已（递归）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>为什么不能写对象</p>
<p>对象可以构成 React 元素，但是没法构建节点，节点需要渲染，没法渲染</p>
<h2 id="更新节点"><a href="#更新节点" class="headerlink" title="更新节点"></a>更新节点</h2><p>更新的场景：</p>
<ol>
<li>重新调用 ReactDOM.render，触发根节点更新</li>
<li>在类组件的实例对象中调用 setState，会导致该实例所在的节点更新</li>
</ol>
<p><strong>节点的更新</strong></p>
<ul>
<li>如果调用的是 ReactDOM.render，进入根节点的<strong>对比（diff）更新</strong></li>
<li>如果调用的是 setState<ul>
<li><ol>
<li>运行生命周期函数，static getDerivedStateFromProps</li>
</ol>
</li>
<li><ol start="2">
<li>运行 shouldComponentUpdate，如果该函数返回 false，终止当前流程</li>
</ol>
</li>
<li><ol start="3">
<li>运行 render，得到一个新的节点，进入该新的节点的<strong>对比更新</strong></li>
</ol>
</li>
<li><ol start="4">
<li>将生命周期函数 getSnapshotBeforeUpdate 加入执行队列，以待将来执行</li>
</ol>
</li>
<li><ol start="5">
<li>将生命周期函数 componentDidUpdate 加入执行队列，以待将来执行</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>以上两点的后续步骤：</p>
<ol>
<li>更新虚拟 DOM 树</li>
<li>完成真实的 DOM 更新</li>
<li>依次调用执行队列中的 componentDidMount</li>
<li>依次调用执行队列中的 getSnapshotBeforeUpdate</li>
<li>依次调用执行队列中的 componentDidUpdate</li>
</ol>
<h3 id="对比更新"><a href="#对比更新" class="headerlink" title="对比更新"></a>对比更新</h3><p>将新产生的节点，对比之前虚拟 DOM 中的节点，发现差异，完成更新</p>
<p>问题：对比之前 DOM 树中哪个节点</p>
<p>React 为了提高对比效率，做出以下假设</p>
<ol>
<li>假设节点不会出现层次的移动（对比时，直接找到旧树中对应位置的节点进行对比）</li>
<li>不同的节点类型会生成不同的结构<ol>
<li>相同的节点类型：节点本身类型相同，如果是由 React 元素生成，type 值还必须一致</li>
<li>其他的，都属于不相同的节点类型</li>
</ol>
</li>
<li>多个兄弟通过唯一标识（key）来确定对比的新节点</li>
</ol>
<p>key 值的作用：用于通过旧节点，寻找对应的新节点，如果某个旧节点有 key 值，则其更新时，会寻找相同层级中的相同 key 值的节点，进行对比。</p>
<p><strong>key 值应该在一个范围内唯一（兄弟节点中），并且应该保持稳定</strong></p>
<h4 id="找到了对比的目标"><a href="#找到了对比的目标" class="headerlink" title="找到了对比的目标"></a>找到了对比的目标</h4><p>判断节点类型是否一致</p>
<ul>
<li><strong>一致</strong></li>
</ul>
<p>根据不同的节点类型，做不同的事情</p>
<p><strong>空节点</strong>：不做任何事情</p>
<p><strong>DOM 节点</strong>：</p>
<ol>
<li>直接重用之前的真实 DOM 对象</li>
<li>将其属性的变化记录下来，以待将来统一完成更新（现在不会真正的变化）</li>
<li>遍历该新的 React 元素的子元素，<strong>递归对比更新</strong></li>
</ol>
<p><strong>文本节点</strong>：</p>
<ol>
<li>直接重用之前的真实 DOM 对象</li>
<li>将新的文本变化记录下来，将来统一完成更新</li>
</ol>
<p><strong>组件节点</strong>：</p>
<p><strong>函数组件</strong>：重新调用函数，得到一个节点对象，进入<strong>递归对比更新</strong></p>
<p><strong>类组件</strong>：</p>
<ol>
<li>重用之前的实例</li>
<li>调用生命周期方法 getDerivedStateFromProps</li>
<li>调用生命周期方法 shouldComponentUpdate，若该方法返回 false，终止</li>
<li>运行 render，得到新的节点对象，进入<strong>递归对比更新</strong></li>
<li>将该对象的 getSnapshotBeforeUpdate 加入队列</li>
<li>将该对象的 componentDidUpdate 加入队列</li>
</ol>
<p><strong>数组节点</strong>：遍历数组进行<strong>递归对比更新</strong></p>
<ul>
<li><strong>不一致</strong></li>
</ul>
<p>整体上，卸载旧的节点，全新创建新的节点</p>
<p><strong>创建新节点</strong></p>
<p>进入新节点的挂载流程</p>
<p><strong>卸载旧节点</strong></p>
<ol>
<li><strong>文本节点、DOM 节点、数组节点、空节点、函数组件节点</strong>：直接放弃该节点，如果节点有子节点，递归卸载节点</li>
<li><strong>类组件节点</strong>：<ol>
<li>直接放弃该节点</li>
<li>调用该节点的 componentWillUnMount 函数</li>
<li>递归卸载子节点</li>
</ol>
</li>
</ol>
<h4 id="没有找到对比的目标"><a href="#没有找到对比的目标" class="headerlink" title="没有找到对比的目标"></a>没有找到对比的目标</h4><p>新的 DOM 树中有节点被删除</p>
<p>新的 DOM 树中有节点添加</p>
<ul>
<li>创建新加入的节点</li>
<li>卸载多余的旧节点</li>
</ul>
<h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><h2 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h2><p>StrictMode(<code>React.StrictMode</code>)，本质是一个组件，该组件不进行 UI 渲染（<code>React.Fragment &lt;&gt; &lt;/&gt;</code>），它的作用是，在渲染内部组件时，发现不合适的代码。</p>
<ul>
<li>识别不安全的生命周期</li>
<li>关于使用过时字符串 ref API 的警告</li>
<li>关于使用废弃的 findDOMNode 方法的警告</li>
<li>检测意外的副作用<ul>
<li>React 要求，副作用代码仅出现在以下生命周期函数中</li>
<li>ComponentDidMount</li>
<li>ComponentDidUpdate</li>
<li>ComponentWillUnMount</li>
</ul>
</li>
</ul>
<p>副作用：一个函数中，做了一些会影响函数外部数据的事情，例如：</p>
<ol>
<li>异步处理</li>
<li>改变参数值</li>
<li>setState</li>
<li>本地存储</li>
<li>改变函数外部的变量</li>
</ol>
<p>相反的，如果一个函数没有副作用，则可以认为该函数是一个纯函数</p>
<p>在严格模式下，虽然不能监控到具体的副作用代码，但它会将不能具有副作用的函数调用两遍，以便发现问题。（这种情况，仅在开发模式下有效）</p>
<ul>
<li>检测过时的 context API</li>
</ul>
<h2 id="Profiler"><a href="#Profiler" class="headerlink" title="Profiler"></a>Profiler</h2><p>性能分析工具</p>
<p>分析某一次或多次提交（更新），涉及到的组件的渲染时间</p>
<p>火焰图：得到某一次提交，每个组件总的渲染时间以及自身的渲染时间</p>
<p>排序图：得到某一次提交，每个组件自身渲染时间的排序</p>
<p>组件图：某一个组件，在多次提交中，自身渲染花费的时间<br>​</p>
<h1 id="HOOK-简介"><a href="#HOOK-简介" class="headerlink" title="HOOK 简介"></a>HOOK 简介</h1><p>HOOK 是 React16.8.0 之后出现</p>
<p>组件：无状态组件（函数组件）、类组件</p>
<p>类组件中的麻烦：</p>
<ol>
<li> this 指向问题</li>
<li> 繁琐的生命周期</li>
<li> 其他问题</li>
</ol>
<p>HOOK 专门用于增强函数组件的功能（HOOK 在类组件中是不能使用的），使之理论上可以成为类组件的替代品</p>
<p>官方强调：没有必要更改已经完成的类组件，官方目前没有计划取消类组件，只是鼓励使用函数组件</p>
<p>HOOK（钩子）本质上是一个函数(命名上总是以<strong>use</strong>开头)，该函数可以挂载任何功能</p>
<p>HOOK 种类：</p>
<ol>
<li>useState 解决状态</li>
<li>useEffect 解决生命周期函数</li>
<li>其他…</li>
</ol>
<p>不同 HOOK 能解决某一方面的功能</p>
<h1 id="State-Hook"><a href="#State-Hook" class="headerlink" title="State Hook"></a>State Hook</h1><p>State Hook 是一个在函数组件中使用的函数（useState），用于在函数组件中使用状态</p>
<p>useState</p>
<ul>
<li>函数有一个参数，这个参数的值表示状态的默认值</li>
<li>函数的返回值是一个数组，该数组一定包含两项<ul>
<li>第一项：当前状态的值</li>
<li>第二项：改变状态的函数</li>
</ul>
</li>
</ul>
<p>一个函数组件中可以有多个状态，这种做法非常有利于横向切分关注点。</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token comment">// 类组件的写法</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
      n<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
              n<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          -
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
              n<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          +
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>函数组件的写法</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useState <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token comment">// 函数组件的写法</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// const arr = useState(0); // 不填默认undefined。使用一个状态，该状态默认值是0</span>
  <span class="token comment">// const n = arr[0]; //得到状态的值</span>
  <span class="token comment">// const setN = arr[1]; //得到一个函数，改函数用于改变状态</span>
  <span class="token comment">// 解构语法简化：</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
      <span class="token punctuation">></span></span><span class="token plain-text">
        -
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
      <span class="token punctuation">></span></span><span class="token plain-text">
        +
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>关注点</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useState <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>visible<span class="token punctuation">,</span> setVisible<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> display<span class="token operator">:</span> visible <span class="token operator">?</span> <span class="token string">"block"</span> <span class="token operator">:</span> <span class="token string">"none"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          -
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          +
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          <span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token operator">!</span>visible<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
      <span class="token punctuation">></span></span><span class="token plain-text">
        显示/隐藏
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>​</p>
<p><strong>注意的细节</strong></p>
<ol>
<li>useState 最好写到函数的起始位置，便于阅读</li>
<li>useState 严禁出现在代码块（判断、循环）中</li>
<li>useState 返回的函数（数组的第二项），引用不变（节约内存空间）</li>
<li>使用函数改变数据，若数据和之前的数据完全相等（使用 Object.is 比较），不会导致重新渲染，以达到优化效率的目的。</li>
<li>使用函数改变数据，传入的值不会和原来的数据进行合并，而是直接替换。不要直接改变对象。setState 是用混合。<blockquote>
<p>应该横切开来，写第二个状态。如果的确需要在一起，就用展开运算符</p>
</blockquote>
</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useState <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> setData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
    x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
        x:</span><span class="token punctuation">&#123;</span>data<span class="token punctuation">.</span>x<span class="token punctuation">&#125;</span><span class="token plain-text">,y:</span><span class="token punctuation">&#123;</span>data<span class="token punctuation">.</span>y<span class="token punctuation">&#125;</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
              <span class="token operator">...</span>data<span class="token punctuation">,</span>
              x<span class="token operator">:</span> data<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          x+1
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="6">
<li>如果要实现强制刷新组件</li>
</ol>
<p>类组件：使用 forceUpdate 函数。不运行 shouldComponentUpdate<br>函数组件：使用一个空对象的 useState</p>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useState <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"App render"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> forceUpdate<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
        <span class="token punctuation">></span></span><span class="token plain-text">
          强制刷新
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="7">
<li><strong>如果某些状态之间没有必然的联系，应该分化为不同的状态，而不要合并成一个对象</strong></li>
<li>和类组件的状态一样，函数组件中改变状态可能是异步的（在 DOM 事件中），多个状态变化会合并以提高效率，此时，不能信任之前的状态，而应该使用回调函数的方式改变状态。如果状态变化要使用到之前的状态，尽量传递函数。</li>
</ol>
<pre class="line-numbers language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> useState <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"render"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//两次改变合并成一个，只运行一次</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
      <span class="token punctuation">></span></span><span class="token plain-text">
        -
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
        <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          <span class="token comment">// setN(n + 1); // 不会立即改变，事件运行完成后一起改变</span>
          <span class="token comment">// setN(n + 1); // 此时n仍是0</span>
          <span class="token function">setN</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prevN</span><span class="token punctuation">)</span> <span class="token operator">=></span> prevN <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 传入的函数，在事件完成后统一运行</span>
          <span class="token function">setN</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prevN</span><span class="token punctuation">)</span> <span class="token operator">=></span> prevN <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span>
      <span class="token punctuation">></span></span><span class="token plain-text">
        +
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="Effect-Hook"><a href="#Effect-Hook" class="headerlink" title="Effect Hook"></a>Effect Hook</h1><p>Effect Hook：用于在函数组件中处理副作用</p>
<p>副作用：</p>
<ol>
<li>ajax 请求</li>
<li>计时器</li>
<li>其他异步操作</li>
<li>更改真实 DOM 对象</li>
<li>本地存储</li>
<li>其他会对外部产生影响的操作</li>
</ol>
<p>函数：useEffect，该函数接收一个函数作为参数，接收的函数就是需要进行副作用操作的函数<br><strong>细节</strong></p>
<ol>
<li>副作用函数的运行时间点，是在页面完成真实的 UI 渲染之后。因此它的执行是异步的，并且不会阻塞浏览器 。所以会有些延迟</li>
</ol>
<p>与类组件中 componentDidMount 和 componentDidUpdate 的区别<br>componentDidMount 和 componentDidUpdate，更改了真实 DOM，但是用户还没有看到 UI 更新，同步的。<br>useEffect 中的副作用函数，更改了真实 DOM，并且用户已经看到了 UI 更新，异步的。</p>
<ol start="2">
<li>每个函数组件中，可以多次使用 useEffect，但不要放入判断或循环等代码块中。</li>
<li>useEffect 中的副作用函数，可以有返回值，返回值必须是一个函数，该函数叫做清理函数<ol>
<li>该函数运行时间点，在每次运行副作用函数之前</li>
<li>首次渲染组件不会运行</li>
<li>组件被销毁时一定会运行</li>
</ol>
</li>
<li>useEffect 函数，可以传递第二个参数<ol>
<li>第二个参数是一个数组</li>
<li>数组中记录该副作用的依赖数据</li>
<li>当组件重新渲染后，只有依赖数据与上一次不一样的时，才会执行副作用</li>
<li>所以，当传递了依赖数据之后，如果数据没有发生变化<ol>
<li>副作用函数仅在第一次渲染后运行</li>
<li>清理函数仅在卸载组件后运行</li>
</ol>
</li>
</ol>
</li>
<li>副作用函数中，如果使用了函数上下文中的变量，则由于闭包的影响，会导致副作用函数中变量不会实时变化。</li>
<li>副作用函数在每次注册时，会覆盖掉之前的副作用函数，因此，尽量保持副作用函数稳定，否则控制起来会比较复杂。</li>
</ol>
<h1 id="自定义-Hook"><a href="#自定义-Hook" class="headerlink" title="自定义 Hook"></a>自定义 Hook</h1><p>State Hook： useState<br>Effect Hook：useEffect</p>
<p>自定义 Hook：将一些常用的、跨越多个组件的 Hook 功能，抽离出去形成一个函数，该函数就是自定义 Hook，自定义 Hook，由于其内部需要使用 Hook 功能，所以它本身也需要按照 Hook 的规则实现：</p>
<ol>
<li>函数名必须以 use 开头</li>
<li>调用自定义 Hook 函数时，应该放到顶层</li>
</ol>
<p>例如：</p>
<ol>
<li>很多组件都需要在第一次加载完成后，获取所有学生数据</li>
<li>很多组件都需要在第一次加载完成后，启动一个计时器，然后在组件销毁时卸载</li>
</ol>
<blockquote>
<p>使用 Hook 的时候，如果没有严格按照 Hook 的规则进行，eslint 的一个插件（eslint-plugin-react-hooks）会报出警告</p>
</blockquote>
<h1 id="Reducer-Hook"><a href="#Reducer-Hook" class="headerlink" title="Reducer Hook"></a>Reducer Hook</h1><p>Flux：Facebook 出品的一个数据流框架</p>
<ol>
<li>规定了数据是单向流动的</li>
<li>数据存储在数据仓库中（目前，可以认为 state 就是一个存储数据的仓库）</li>
<li><strong>action 是改变数据的唯一原因</strong>（本质上就是一个对象，action 有两个属性）<ol>
<li>type：字符串，动作的类型</li>
<li>payload：任意类型，动作发生后的附加信息</li>
<li>例如，如果是添加一个学生，action 可以描述为：<ol>
<li><code>&#123; type:&quot;addStudent&quot;, payload: &#123;学生对象的各种信息&#125; &#125;</code></li>
</ol>
</li>
<li>例如，如果要删除一个学生，action 可以描述为：<ol>
<li><code>&#123; type:&quot;deleteStudent&quot;, payload: 学生id &#125;</code></li>
</ol>
</li>
</ol>
</li>
<li><strong>具体改变数据</strong>的是一个函数，该函数叫做<strong>reducer</strong><ol>
<li>该函数接收两个参数<ol>
<li>state：表示当前数据仓库中的数据</li>
<li>action：描述了如何去改变数据，以及改变数据的一些附加信息</li>
</ol>
</li>
<li>该函数必须有一个返回结果，用于表示数据仓库变化之后的数据<ol>
<li>Flux 要求，对象是不可变的，如果返回对象，必须创建新的对象</li>
</ol>
</li>
<li>reducer 必须是纯函数，不能有任何副作用</li>
</ol>
</li>
<li>如果要触发 reducer，<strong>不可以直接调用</strong>，而是应该调用一个辅助函数<strong>dispatch</strong><ol>
<li>该函数仅接收一个参数：action</li>
<li>该函数会间接去调用 reducer，以达到改变数据的目的</li>
</ol>
</li>
</ol>
<h1 id="Context-Hook"><a href="#Context-Hook" class="headerlink" title="Context Hook"></a>Context Hook</h1><p>用于获取上下文数据<br>​</p>
<h1 id="Callback-Hook"><a href="#Callback-Hook" class="headerlink" title="Callback Hook"></a>Callback Hook</h1><p>函数名：useCallback</p>
<p>用于得到一个固定引用值的函数，通常用它进行性能优化</p>
<p>useCallback:</p>
<p>该函数有两个参数：</p>
<ol>
<li>函数，useCallback 会固定该函数的引用，<strong>只要依赖项没有发生变化，则始终返回之前函数的地址</strong></li>
<li>数组，记录依赖项</li>
</ol>
<p>该函数返回：引用相对固定的函数地址<br>​</p>
<h1 id="Memo-Hook"><a href="#Memo-Hook" class="headerlink" title="Memo Hook"></a>Memo Hook</h1><p>用于保持一些比较稳定的数据，通常用于性能优化</p>
<p><strong>如果 React 元素本身的引用没有发生变化，一定不会重新渲染</strong></p>
<h1 id="Ref-Hook"><a href="#Ref-Hook" class="headerlink" title="Ref Hook"></a>Ref Hook</h1><p>useRef 函数：</p>
<ol>
<li>一个参数：默认值</li>
<li>返回一个<strong>固定的对象</strong>，<code>&#123;current: 值&#125;</code></li>
</ol>
<p><strong>可以做到每一个组件有一个唯一地址</strong><br>​</p>
<h1 id="ImperativeHandle-Hook"><a href="#ImperativeHandle-Hook" class="headerlink" title="ImperativeHandle Hook"></a>ImperativeHandle Hook</h1><p>函数：useImperativeHandleHook</p>
<h1 id="LayoutEffect-Hook"><a href="#LayoutEffect-Hook" class="headerlink" title="LayoutEffect Hook"></a>LayoutEffect Hook</h1><p>​</p>
<p>useEffect：浏览器渲染完成后，用户看到新的渲染结果之后<br>useLayoutEffectHook：完成了<strong>DOM</strong>改动，但还没有呈现给用户运行</p>
<p><strong>应该尽量使用 useEffect，因为它不会导致渲染阻塞</strong>，如果出现了问题，再考虑使用 useLayoutEffectHook。使用上和 useEffect 没有区别<br>​</p>
<h1 id="DebugValue-Hook"><a href="#DebugValue-Hook" class="headerlink" title="DebugValue Hook"></a>DebugValue Hook</h1><p>useDebugValue：用于将自定义 Hook 的关联数据显示到调试栏</p>
<p>如果创建的自定义 Hook 通用性比较高，可以选择使用 useDebugValue 方便调试<br>​</p>
<h1 id="React-动画"><a href="#React-动画" class="headerlink" title="React 动画"></a>React 动画</h1><p>React 动画库：react-transition-group<br><strong>文档在 npm 搜索</strong><br><a target="_blank" rel="noopener" href="https://reactcommunity.org/react-transition-group/">https://reactcommunity.org/react-transition-group/</a><br><strong>​</strong></p>
<h1 id="React-动画-CSSTransition"><a href="#React-动画-CSSTransition" class="headerlink" title="React 动画 - CSSTransition"></a>React 动画 - CSSTransition</h1><p>当进入时，发生：</p>
<ol>
<li>为 CSSTransition 内部的 DOM 根元素（后续统一称之为 DOM 元素）添加样式 enter</li>
<li>在一下帧(enter 样式已经完全应用到了元素)，立即为该元素添加样式 enter-active</li>
<li>当 timeout 结束后，去掉之前的样式，添加样式 enter-done</li>
</ol>
<p>当退出时，发生：</p>
<ol>
<li>为 CSSTransition 内部的 DOM 根元素（后续统一称之为 DOM 元素）添加样式 exit</li>
<li>在一下帧(exit 样式已经完全应用到了元素)，立即为该元素添加样式 exit-active</li>
<li>当 timeout 结束后，去掉之前的样式，添加样式 exit-done</li>
</ol>
<p>设置<strong>classNames</strong>属性，可以指定类样式的名称</p>
<ol>
<li>字符串：为类样式添加<strong>前缀</strong></li>
<li>对象：为每个类样式指定具体的名称（非前缀）</li>
</ol>
<p><strong>关于首次渲染时的类样式，appear、apear-active、apear-done，它和 enter 的唯一区别在于完成时，会同时加入 apear-done 和 enter-done</strong></p>
<p>还可以与 Animate.css 联用<br>​</p>
<h1 id="React-动画-SwitchTransition"><a href="#React-动画-SwitchTransition" class="headerlink" title="React 动画 - SwitchTransition"></a>React 动画 - SwitchTransition</h1><p>和 CSSTransition 的区别：用于<strong>有秩序</strong>的切换内部组件</p>
<p>默认情况下：out-in 先退出后进入</p>
<ol>
<li>当 key 值改变时，会将之前的 DOM 根元素添加退出样式（exit,exit-active)</li>
<li>退出完成后，将该 DOM 元素移除</li>
<li>重新渲染内部 DOM 元素</li>
<li>为新渲染的 DOM 根元素添加进入样式(enter, enter-active, enter-done)</li>
</ol>
<p>in-out:</p>
<ol>
<li>重新渲染内部 DOM 元素，保留之前的元素</li>
<li>为新渲染的 DOM 根元素添加进入样式(enter, enter-active, enter-done)</li>
<li>将之前的 DOM 根元素添加退出样式（exit,exit-active)</li>
<li>退出完成后，将该 DOM 元素移除</li>
</ol>
<blockquote>
<p>该库寻找 dom 元素的方式，是使用已经过时的 API：findDomNode，该方法可以找到某个组件下的 DOM 根元素，先保留，创建新的之后在删除</p>
</blockquote>
<h1 id="React-动画-TransitionGroup"><a href="#React-动画-TransitionGroup" class="headerlink" title="React 动画 - TransitionGroup"></a>React 动画 - TransitionGroup</h1><p>该组件的 children，接收多个 Transition 或 CSSTransition 组件，该组件用于根据这些子组件的 key 值，控制他们的进入和退出状态</p>
<h1 id="React-Router-概述"><a href="#React-Router-概述" class="headerlink" title="React Router 概述"></a>React Router 概述</h1><p>React 路由</p>
<h2 id="站点"><a href="#站点" class="headerlink" title="站点"></a>站点</h2><p>无论是使用 Vue，还是 React，开发的单页应用程序，可能只是该站点的一部分（某一个功能块）</p>
<p>一个单页应用里，可能会划分为多个页面（几乎完全不同的页面效果）（组件）</p>
<p>如果要在单页应用中完成组件的切换，需要实现下面两个功能：</p>
<ol>
<li>根据不同的页面地址，展示不同的组件（核心）</li>
<li>完成无刷新的地址切换</li>
</ol>
<p>我们把实现了以上两个功能的插件，称之为路由</p>
<h2 id="React-Router"><a href="#React-Router" class="headerlink" title="React Router"></a>React Router</h2><ol>
<li>react-router：路由核心库，包含诸多和路由功能相关的核心代码</li>
<li>react-router-dom：利用路由核心库，结合实际的页面，实现跟页面路由密切相关的功能</li>
</ol>
<p>如果是在页面中实现路由，需要安装 react-router-dom 库</p>
<h1 id="两种模式"><a href="#两种模式" class="headerlink" title="两种模式"></a>两种模式</h1><p>路由：根据不同的页面地址，展示不同的组件</p>
<p>url 地址组成</p>
<p>例：<a target="_blank" rel="noopener" href="https://www.react.com/news/1-2-1.html?a=1&b=2#abcdefg">https://www.react.com:443/news/1-2-1.html?a=1&amp;b=2#abcdefg</a></p>
<ol>
<li>协议名(schema)：https</li>
<li>主机名(host)：<a target="_blank" rel="noopener" href="http://www.react.com/">www.react.com</a><ol>
<li>ip 地址</li>
<li>预设值：localhost</li>
<li>域名</li>
<li>局域网中电脑名称</li>
</ol>
</li>
<li>端口号(port)：443<ol>
<li>如果协议是 http，端口号是 80，则可以省略端口号</li>
<li>如果协议是 https，端口号是 443，则可以省略端口号</li>
</ol>
</li>
<li>路径(path)：/news/1-2-1.html</li>
<li>地址参数(search、query)：?a=1&amp;b=2<ol>
<li>附带的数据</li>
<li>格式：属性名=属性值&amp;属性名=属性值….</li>
</ol>
</li>
<li>哈希(hash、锚点)<ol>
<li>附带的数据</li>
</ol>
</li>
</ol>
<h2 id="Hash-Router-哈希路由"><a href="#Hash-Router-哈希路由" class="headerlink" title="Hash Router 哈希路由"></a>Hash Router 哈希路由</h2><p>根据 url 地址中的哈希值来确定显示的组件</p>
<blockquote>
<p>原因：hash 的变化，不会导致页面刷新<br>这种模式的兼容性最好</p>
</blockquote>
<h2 id="Borswer-History-Router-浏览器历史记录路由"><a href="#Borswer-History-Router-浏览器历史记录路由" class="headerlink" title="Borswer History Router 浏览器历史记录路由"></a>Borswer History Router 浏览器历史记录路由</h2><p>之前存在的 api：history.forward(), history.back(), history.go()<br>HTML5 出现后，新增了 History Api，从此以后，浏览器拥有了改变路径而不刷新页面的方式</p>
<p>History 表示浏览器的历史记录，它使用栈的方式存储。</p>
<ol>
<li>history.length：获取栈中数据量</li>
<li>history.pushState：向当前历史记录栈中加入一条新的记录<ol>
<li>参数 1：附加的数据，自定义的数据，可以是任何类型</li>
<li>参数 2：页面标题，目前大部分浏览器不支持</li>
<li>参数 3：新的地址</li>
</ol>
</li>
<li>history.replaceState：将当前指针指向的历史记录，替换为某个记录<ol>
<li>参数 1：附加的数据，自定义的数据，可以是任何类型</li>
<li>参数 2：页面标题，目前大部分浏览器不支持</li>
<li>参数 3：新的地址</li>
</ol>
</li>
</ol>
<p>根据页面的路径决定渲染哪个组件，不是根据哈希了<br>​</p>
<h1 id="路由组件"><a href="#路由组件" class="headerlink" title="路由组件"></a>路由组件</h1><p>React-Router 为我们提供了两个重要组件</p>
<h2 id="Router-组件"><a href="#Router-组件" class="headerlink" title="Router 组件"></a>Router 组件</h2><p>它本身不做任何展示，仅提供路由模式配置，另外，该组件会产生一个上下文，上下文中会提供一些实用的对象和方法，供其他相关组件使用</p>
<ol>
<li>HashRouter：该组件，使用 hash 模式匹配</li>
<li>BrowserRouter：该组件，使用 BrowserHistory 模式匹配</li>
</ol>
<p>通常情况下，Router 组件只有一个，将该组件包裹整个页面</p>
<h2 id="Route-组件"><a href="#Route-组件" class="headerlink" title="Route 组件"></a>Route 组件</h2><p>根据不同的地址，展示不同的组件</p>
<p>重要属性：</p>
<ol>
<li>path：匹配的路径<ol>
<li>默认情况下，不区分大小写，可以设置 sensitive 属性为 true，来区分大小写</li>
<li>默认情况下，只匹配初始目录，如果要精确匹配，配置 exact 属性为 true</li>
<li>如果不写 path，则会匹配任意路径</li>
</ol>
</li>
<li>component：匹配成功后要显示的组件</li>
<li>children：<ol>
<li>传递 React 元素，无论是否匹配，一定会显示 children，并且会忽略 component 属性</li>
<li>传递一个函数，该函数有多个参数，这些参数来自于上下文，该函数返回 react 元素，则一定会显示返回的元素，并且忽略 component 属性.</li>
</ol>
</li>
</ol>
<p>Route 组件可以写到任意的地方，只要保证它是 Router 组件的后代元素</p>
<h2 id="Switch-组件"><a href="#Switch-组件" class="headerlink" title="Switch 组件"></a>Switch 组件</h2><p>写到 Switch 组件中的 Route 组件，当匹配到第一个 Route 后，会立即停止匹配</p>
<p>由于 Switch 组件会循环所有子元素，然后让每个子元素去完成匹配，若匹配到，则渲染对应的组件，然后停止循环。因此，不能在 Switch 的子元素中使用除 Route 外的其他组件。<br>​</p>
<h1 id="路由信息"><a href="#路由信息" class="headerlink" title="路由信息"></a>路由信息</h1><p>Router 组件会创建一个上下文，并且，向上下文中注入一些信息</p>
<p>该上下文对开发者是隐藏的，Route 组件若匹配到了地址，则会将这些上下文中的信息作为属性传入对应的组件</p>
<h2 id="history"><a href="#history" class="headerlink" title="history"></a>history</h2><p>它并不是 window.history 对象，我们利用该对象无刷新跳转地址</p>
<p><strong>为什么没有直接使用 history 对象</strong></p>
<ol>
<li>React-Router 中有两种模式：Hash、History，如果直接使用 window.history，只能支持一种模式。为了适配两种模式</li>
<li>当使用 windows.history.pushState 方法时，没有办法收到任何通知，将导致 React 无法知晓地址发生了变化，结果导致无法重新渲染组件</li>
</ol>
<ul>
<li>push：将某个新的地址入栈（历史记录栈）<ul>
<li>参数 1：新的地址</li>
<li>参数 2：可选，附带的状态数据</li>
</ul>
</li>
<li>replace：将某个新的地址替换掉当前栈中的地址</li>
<li>go: 与 window.history 一致</li>
<li>forward: 与 window.history 一致</li>
<li>back: 与 window.history 一致</li>
</ul>
<h2 id="location"><a href="#location" class="headerlink" title="location"></a>location</h2><p>与 history.location 完全一致，是同一个对象，但是，与 window.location 不同</p>
<p>location 对象中记录了当前地址的相关信息</p>
<p>我们通常使用第三方库<code>query-string</code>，用于解析地址栏中的数据</p>
<h2 id="match"><a href="#match" class="headerlink" title="match"></a>match</h2><p>该对象中保存了，路由匹配的相关信息</p>
<ul>
<li>isExact：事实上，当前的路径和路由配置的路径是否是精确匹配的。和 exact 写没写无关</li>
<li>params：获取路径规则中对应的数据</li>
</ul>
<p>实际上，在书写 Route 组件的 path 属性时，可以书写一个<code>string pattern</code>（字符串正则）</p>
<p>react-router 使用了第三方库：Path-to-RegExp，该库的作用是，将一个字符串正则转换成一个真正的正则表达式。</p>
<p><strong>向某个页面传递数据的方式：</strong></p>
<ol>
<li>使用 state：在 push 页面时，加入 state</li>
<li><strong>利用 search：把数据填写到地址栏中的？后</strong></li>
<li>利用 hash：把数据填写到 hash 后</li>
<li><strong>params：把数据填写到路径中</strong></li>
</ol>
<h2 id="非路由组件获取路由信息"><a href="#非路由组件获取路由信息" class="headerlink" title="非路由组件获取路由信息"></a>非路由组件获取路由信息</h2><p>某些组件，并没有直接放到 Route 中，而是嵌套在其他普通组件中，因此，它的 props 中没有路由信息，如果这些组件需要获取到路由信息，可以使用下面两种方式：</p>
<ol>
<li>将路由信息从父组件一层一层传递到子组件</li>
<li>使用 react-router 提供的高阶组件 withRouter，包装要使用的组件，该高阶组件会返回一个新组件，新组件将向提供的组件注入路由信息。</li>
</ol>
<h1 id="其他组件"><a href="#其他组件" class="headerlink" title="其他组件"></a>其他组件</h1><p>已学习：</p>
<ul>
<li>Router：BrowswerRouter、HashRouter</li>
<li>Route</li>
<li>Switch</li>
<li>高阶函数：withRouter</li>
</ul>
<h2 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h2><p>生成一个无刷新跳转的 a 元素</p>
<ul>
<li>to<ul>
<li>字符串：跳转的目标地址</li>
<li>对象：<ul>
<li>pathname：url 路径</li>
<li>search</li>
<li>hash</li>
<li>state：附加的状态信息</li>
</ul>
</li>
</ul>
</li>
<li>replace：bool，表示是否是替换当前地址，默认是 false，是 push 跳转</li>
<li>innerRef：可以将内部的 a 元素的 ref 附着在传递的对象或函数参数上<ul>
<li>函数</li>
<li>ref 对象</li>
</ul>
</li>
</ul>
<h2 id="NavLink"><a href="#NavLink" class="headerlink" title="NavLink"></a>NavLink</h2><p>是一种特殊的 Link，Link 组件具备的功能，它都有</p>
<p>它具备的额外功能是：根据当前地址和链接地址，来决定该链接的样式</p>
<ul>
<li>activeClassName: 匹配时使用的类名</li>
<li>activeStyle: 匹配时使用的内联样式</li>
<li>exact: 是否精确匹配</li>
<li>sensitive：匹配时是否区分大小写</li>
<li>strict：是否严格匹配最后一个斜杠</li>
</ul>
<h2 id="Redirect"><a href="#Redirect" class="headerlink" title="Redirect"></a>Redirect</h2><p>重定向组件，当加载到该组件时，会自动跳转（无刷新）到另外一个地址</p>
<ul>
<li>to：跳转的地址<ul>
<li>字符串</li>
<li>对象</li>
</ul>
</li>
<li>push: 默认为 false，表示跳转使用替换的方式，设置为 true 后，则使用 push 的方式跳转</li>
<li>from：当匹配到 from 地址规则时才进行跳转</li>
<li>exact: 是否精确匹配 from</li>
<li>sensitive：from 匹配时是否区分大小写</li>
<li>strict：from 是否严格匹配最后一个斜杠</li>
</ul>
<blockquote>
<p>vue-router 和 React router</p>
</blockquote>
<p>vue-router 是一个静态的配置<br>react-router v4 之前 静态的配置<br>现在 react-router 是动态的组件，灵活了<br>​</p>
<h1 id="导航守卫"><a href="#导航守卫" class="headerlink" title="导航守卫"></a>导航守卫</h1><p>导航守卫：当离开一个页面，进入另一个页面时，触发的事件</p>
<p>history 对象</p>
<ul>
<li>listen: 添加一个监听器，监听地址的变化，当地址发生变化时，会调用传递的函数<ul>
<li>参数：函数，运行时间点：发生在即将跳转到新页面时<ul>
<li>参数 1：location 对象，记录当前的地址信息</li>
<li>参数 2：action，一个字符串，表示进入该地址的方式<ul>
<li>POP：出栈 （指针移动）<ul>
<li>通过点击浏览器后退、前进</li>
<li>调用 history.go</li>
<li>调用 history.goBack</li>
<li>调用 history.goForward</li>
</ul>
</li>
<li>PUSH：入栈 （指针移动）<ul>
<li>history.push</li>
</ul>
</li>
<li>REPLACE：替换<ul>
<li>history.replace</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>返回结果：函数，可以调用该函数取消监听</li>
</ul>
</li>
<li>block：设置一个阻塞，并同时设置阻塞消息，当页面发生跳转时，会进入阻塞，并将阻塞消息传递到路由根组件的 getUserConfirmation 方法。<ul>
<li>返回一个回调函数，用于取消阻塞器</li>
</ul>
</li>
</ul>
<p>路由根组件</p>
<ul>
<li>getUserConfirmation<ul>
<li>参数：函数<ul>
<li>参数 1：阻塞消息<ul>
<li>字符串消息</li>
<li>函数，函数的返回结果是一个字符串，用于表示阻塞消息<ul>
<li>参数 1：location 对象</li>
<li>参数 2：action 值</li>
</ul>
</li>
</ul>
</li>
<li>参数 2：回调函数，调用该函数并传递 true，则表示进入到新页面，否则，不做任何操作</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="常见应用-路由切换动画"><a href="#常见应用-路由切换动画" class="headerlink" title="常见应用 - 路由切换动画"></a>常见应用 - 路由切换动画</h1><p>第三方动画库：react-transition-group</p>
<p>CSSTransition：用于为内部的 DOM 元素添加类样式，通过 in 属性决定内部的 DOM 处于退出还是进入阶段。</p>
<h1 id="滚动条复位"><a href="#滚动条复位" class="headerlink" title="滚动条复位"></a>滚动条复位</h1><h2 id="高阶组件"><a href="#高阶组件" class="headerlink" title="高阶组件"></a>高阶组件</h2><h2 id="使用-useEffect"><a href="#使用-useEffect" class="headerlink" title="使用 useEffect"></a>使用 useEffect</h2><h2 id="使用自定义的导航守卫"><a href="#使用自定义的导航守卫" class="headerlink" title="使用自定义的导航守卫"></a>使用自定义的导航守卫</h2><h1 id="Redux-核心概念"><a href="#Redux-核心概念" class="headerlink" title="Redux 核心概念"></a>Redux 核心概念</h1><p>action  reducer  store</p>
<h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><p>它是一个 UI 的解决方案，用于降低 UI，以及 UI 关联的数据的复杂度。</p>
<p><strong>传统的服务器端的 MVC</strong></p>
<p>环境：</p>
<ol>
<li>服务端需要响应一个完整的 HTML</li>
<li>该 HTML 中包含页面需要的数据</li>
<li>浏览器仅承担渲染页面的作用</li>
</ol>
<p>以上的这种方式叫做<strong>服务端渲染</strong>，即服务器端将完整的页面组装好之后，一起发送给客户端。</p>
<p>服务器端需要处理 UI 中要用到的数据，并且要将数据嵌入到页面中，最终生成一个完整的 HTML 页面响应。</p>
<p>为了降低处理这个过程的复杂度，出现了 MVC 模式。</p>
<p><strong>Controller</strong>: 处理请求，组装这次请求需要的数据<br><strong>Model</strong>：需要用于 UI 渲染的数据模型<br><strong>View</strong>：视图，用于将模型组装到界面中</p>
<p><strong>前后端分离</strong><br><strong>前端 MVC 模式的困难</strong></p>
<p>React 解决了   数据 -&gt; 视图   的问题<br>​</p>
<blockquote>
<p>解决了 MVC 的 V</p>
</blockquote>
<ol>
<li>前端的 controller 要比服务器复杂很多，因为前端中的 controller 处理的是用户的操作，而用户的操作场景是复杂的。</li>
<li>对于那些组件化的框架（比如 vue、react），它们使用的是单向数据流。若需要共享数据，则必须将数据提升到顶层组件，然后数据再一层一层传递，极其繁琐。 虽然可以使用上下文来提供共享数据，但对数据的操作难以监控，容易导致调试错误的困难，以及数据还原的困难。并且，若开发一个大中型项目，共享的数据很多，会导致上下文中的数据变得非常复杂。</li>
</ol>
<p>比如，上下文中有如下格式的数据：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">value <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  users<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">addUser</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">deleteUser</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">updateUser</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token comment">//  这些方法都可能改变数据，发生错误难以调试</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="前端需要一个独立的数据解决方案"><a href="#前端需要一个独立的数据解决方案" class="headerlink" title="前端需要一个独立的数据解决方案"></a>前端需要一个独立的数据解决方案</h2><blockquote>
<p>独立：可不一定是 react,根本就没关系</p>
</blockquote>
<p><strong>Flux</strong></p>
<p>Facebook 提出的数据解决方案，它的最大历史意义，在于它引入了 action 的概念</p>
<p>action 是一个普通的对象，用于描述要干什么。<strong>action 是触发数据变化的唯一原因</strong></p>
<p>store 表示数据仓库，用于存储共享数据。还可以根据不同的 action 更改仓库中的数据</p>
<p>示例：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> loginAction <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  type<span class="token operator">:</span> <span class="token string">"login"</span><span class="token punctuation">,</span>
  payload<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    loginId<span class="token operator">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
    loginPwd<span class="token operator">:</span> <span class="token string">"123123"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> deleteAction <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  type<span class="token operator">:</span> <span class="token string">"delete"</span><span class="token punctuation">,</span>
  payload<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 用户id为1</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Redux</strong></p>
<p>在 Flux 基础上，引入了 reducer 的概念</p>
<p>reducer：处理器，用于根据 action 来处理数据，处理后的数据会被仓库重新保存。</p>
<h1 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h1><ol>
<li><p>action 是一个 plain-object（平面对象）</p>
<ol>
<li>它的<strong>proto</strong>指向 Object.prototype</li>
</ol>
</li>
<li><p>通常，使用 payload 属性表示附加数据（没有强制要求）</p>
</li>
<li><p>action 中必须有 type 属性，该属性用于描述操作的类型</p>
<ol>
<li>但是，没有对 type 的类型做出要求</li>
</ol>
</li>
<li><p>在大型项目，由于操作类型非常多，为了避免硬编码（hard code），会将 action 的类型存放到一个或一些单独的文件中(样板代码)。</p>
</li>
<li><p>为了方面传递 action，通常会使用 action 创建函数(action creator)来创建 action</p>
<ol>
<li>action 创建函数应为无副作用的纯函数<ol>
<li>不能以任何形式改动参数</li>
<li>不可以有异步</li>
<li>不可以对外部环境中的数据造成影响</li>
</ol>
</li>
</ol>
</li>
<li><p>为了方便利用 action 创建函数来分发（触发）action，redux 提供了一个函数<code>bindActionCreators</code>，该函数用于增强 action 创建函数的功能，使它不仅可以创建 action，并且创建后会自动完成分发。</p>
</li>
</ol>
<h1 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h1><p>Reducer 是用于改变数据的函数</p>
<ol>
<li>一个数据仓库，有且仅有一个 reducer，并且通常情况下，一个工程只有一个仓库，因此，一个系统，只有一个 reducer</li>
<li>为了方便管理，通常会将 reducer 放到单独的文件中。</li>
<li>reducer 被调用的时机<ol>
<li>通过 store.dispatch，分发了一个 action，此时，会调用 reducer</li>
<li>当创建一个 store 的时候，会调用一次 reducer<ol>
<li>可以利用这一点，用 reducer 初始化状态</li>
<li>创建仓库时，不传递任何默认状态</li>
<li>将 reducer 的参数 state 设置一个默认值。创建仓库不写默认值，传递 reducer 的时候传递默认值</li>
</ol>
</li>
</ol>
</li>
<li>reducer 内部通常使用 switch 来判断 type 值</li>
<li><strong>reducer 必须是一个没有副作用的纯函数</strong><ol>
<li>为什么需要纯函数<ol>
<li>纯函数有利于测试和调式</li>
<li>有利于还原数据</li>
<li>有利于将来和 react 结合时的优化</li>
</ol>
</li>
<li>具体要求<ol>
<li>不能改变参数，因此若要让状态变化，必须得到一个新的状态</li>
<li>不能有异步</li>
<li>不能对外部环境造成影响</li>
</ol>
</li>
</ol>
</li>
<li>由于在大中型项目中，操作比较复杂，数据结构也比较复杂，因此，需要对 reducer 进行细分。<ol>
<li>redux 提供了方法，可以帮助我们更加方便的合并 reducer</li>
<li>combineReducers: 合并 reducer，得到一个新的 reducer，该新的 reducer 管理一个对象，该对象中的每一个属性交给对应的 reducer 管理。</li>
</ol>
</li>
</ol>
<h1 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h1><p>Store：用于保存数据</p>
<p>通过 createStore 方法创建的对象。</p>
<p>该对象的成员：</p>
<ul>
<li>dispatch：分发一个 action</li>
<li>getState：得到仓库中当前的状态</li>
<li>replaceReducer：替换掉当前的 reducer</li>
<li>subscribe：注册一个监听器，监听器是一个无参函数，该分发一个 action 之后，会运行注册的监听器。该函数会返回一个函数，用于取消监听。可以注册多个监听器</li>
</ul>
<h1 id="createStore"><a href="#createStore" class="headerlink" title="createStore"></a>createStore</h1><p>返回一个对象：</p>
<ul>
<li>dispatch：分发一个 action</li>
<li>getState：得到仓库中当前的状态</li>
<li>subscribe：注册一个监听器，监听器是一个无参函数，该分发一个 action 之后，会运行注册的监听器。该函数会返回一个函数，用于取消监听</li>
</ul>
<h1 id="bindActionCreators"><a href="#bindActionCreators" class="headerlink" title="bindActionCreators"></a>bindActionCreators</h1><h1 id="combineReducers"><a href="#combineReducers" class="headerlink" title="combineReducers"></a>combineReducers</h1><p>组装 reducers，返回一个 reducer，数据使用一个对象表示，对象的属性名与传递的参数对象保持一致</p>
<h1 id="Redux-中间件（Middleware）"><a href="#Redux-中间件（Middleware）" class="headerlink" title="Redux 中间件（Middleware）"></a>Redux 中间件（Middleware）</h1><p>中间件：类似于插件，可以在不影响原本功能、并且不改动原本代码的基础上，对其功能进行增强。在 Redux 中，中间件主要用于增强 dispatch 函数。</p>
<p>实现 Redux 中间件的基本原理，是更改仓库中的 dispatch 函数。</p>
<p>Redux 中间件书写：</p>
<ul>
<li>中间件本身是一个函数，该函数接收一个 store 参数，表示创建的仓库，该仓库并非一个完整的仓库对象，仅包含 getState，dispatch。该函数运行的时间，是在仓库创建之后运行。<ul>
<li>由于创建仓库后需要自动运行设置的中间件函数，因此，需要在创建仓库时，告诉仓库有哪些中间件</li>
<li>需要调用 applyMiddleware 函数，将函数的返回结果作为 createStore 的第二或第三个参数。</li>
</ul>
</li>
<li>中间件函数必须返回一个 dispatch 创建函数</li>
<li>applyMiddleware 函数，用于记录有哪些中间件，它会返回一个函数<ul>
<li>该函数用于记录创建仓库的方法，然后又返回一个函数</li>
</ul>
</li>
</ul>
<h1 id="手写-applyMiddleware【没理解】"><a href="#手写-applyMiddleware【没理解】" class="headerlink" title="手写 applyMiddleware【没理解】"></a>手写 applyMiddleware【没理解】</h1><p>middleware 的本质，是一个调用后可以得到 dispatch 创建函数的函数</p>
<p>compose：函数组合，将一个数组中的函数进行组合，形成一个新的函数，该函数调用时，实际上是<strong>反向调用</strong>之前组合的函数</p>
<h1 id="利用中间件进行副作用处理"><a href="#利用中间件进行副作用处理" class="headerlink" title="利用中间件进行副作用处理"></a>利用中间件进行副作用处理</h1><ul>
<li><strong>redux-thunk</strong></li>
</ul>
<p>thunk 允许 action 是一个带有<strong>副作用</strong>的函数，当 action 是一个函数被分发时，thunk 会阻止 action 继续向后移交,会直接调用函数<br><img src="https://cdn.nlark.com/yuque/0/2021/jpeg/758572/1635249332373-ec6997e8-ac67-451b-9e02-b13c7257c9fe.jpeg#clientId=u2d168f52-54c5-4&from=drop&height=345&id=u2572fb72&margin=%5Bobject%20Object%5D&name=IMG_20211026_195430.jpg&originHeight=3000&originWidth=4000&originalType=binary&ratio=1&size=4772766&status=done&style=none&taskId=u749696e7-8e5c-44d4-bbf0-9fb48be703b&width=460" alt="IMG_20211026_195430.jpg"></p>
<p>thunk 会向函数中传递三个参数：</p>
<ul>
<li><p>dispatch：来自于 store.dispatch</p>
</li>
<li><p>getState：来自于 store.getState</p>
</li>
<li><p>extra：来自于用户设置的额外参数</p>
</li>
<li><p>** redux-promise **</p>
</li>
<li><p>** redux-saga **</p>
</li>
</ul>
<h1 id="用-Reudx-thunk-管理学生数据"><a href="#用-Reudx-thunk-管理学生数据" class="headerlink" title="用 Reudx + thunk 管理学生数据"></a>用 Reudx + thunk 管理学生数据</h1><p>需求：根据关键字、性别、分页信息查询学生</p>
<p><strong>查询条件</strong></p>
<ul>
<li>关键字：字符串，可为空字符串</li>
<li>性别：1、0、-1，分别表示查询女、男、不限</li>
<li>当前页码</li>
<li>页容量</li>
</ul>
<p><strong>查询结果</strong></p>
<ul>
<li>学生数组</li>
<li>学生总数</li>
<li>查询状态：是否正在查询中</li>
</ul>
<h1 id="redux-promise"><a href="#redux-promise" class="headerlink" title="redux-promise"></a>redux-promise</h1><p><strong>如果 action 是一个 promise，则会等待 promise 完成，将完成的结果作为 action 触发</strong>，如果 action 不是一个 promise，则判断其 payload 是否是一个 promise，如果是，等待 promise 完成，然后将得到的结果作为 payload 的值触发。<br>​</p>
<h1 id="迭代器和可迭代协议"><a href="#迭代器和可迭代协议" class="headerlink" title="迭代器和可迭代协议"></a>迭代器和可迭代协议</h1><blockquote>
<p>解决副作用的 redux 中间件<br>redux-thunk：需要改动 action，可接收 action 是一个函数<br>redux-promise：需要改动 action，可接收 action 是一个 promise 对象，或 action 的 payload 是一个 promise 对象<br>以上两个中间件，会导致 action 或 action 创建函数不再纯净。<br>redux-saga 将解决这样的问题，它不仅可以保持 action、action 创建函数、reducer 的纯净，而且可以用模块化的方式解决副作用，并且功能非常强大。<br>redux-saga 是建立在 ES6 的生成器基础上的，要熟练的使用 saga，必须理解生成器。<br>要理解生成器，必须先理解迭代器和可迭代协议。</p>
</blockquote>
<h2 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h2><p>类似于遍历</p>
<p>遍历：有多个数据组成的集合数据结构（map、set、array 等其他类数组），需要从该结构中依次取出数据进行某种处理。</p>
<p>迭代：按照某种逻辑，依次取出下一个数据进行处理。</p>
<h2 id="迭代器-iterator"><a href="#迭代器-iterator" class="headerlink" title="迭代器 iterator"></a>迭代器 iterator</h2><p>JS 语言规定，如果一个对象具有 next 方法，并且 next 方法满足一定的约束，则该对象是一个迭代器（iterator）。</p>
<p>next 方法的约束：该方法必须返回一个对象，该对象至少具有两个属性：</p>
<ul>
<li>value：any 类型，下一个数据的值，如果 done 属性为 true，通常，会将 value 设置为 undefined</li>
<li>done：bool 类型，是否已经迭代完成</li>
</ul>
<p>通过迭代器的 next 方法，可以依次取出数据，并可以根据返回的 done 属性，判定是否迭代结束。</p>
<h3 id="迭代器创建函数-iterator-creator"><a href="#迭代器创建函数-iterator-creator" class="headerlink" title="迭代器创建函数 iterator creator"></a>迭代器创建函数 iterator creator</h3><p>它是指一个函数，调用该函数后，返回一个迭代器，则该函数称之为迭代器创建函数，可以简称位迭代器函数。</p>
<h2 id="可迭代协议"><a href="#可迭代协议" class="headerlink" title="可迭代协议"></a>可迭代协议</h2><p>ES6 中出现了 for-of 循环，该循环就是用于迭代某个对象的，因此，for-of 循环要求对象必须是可迭代的（对象必须满足可迭代协议）</p>
<p>可迭代协议是用于约束一个对象的，如果一个对象满足下面的规范，则该对象满足可迭代协议，也称之为该对象是可以被迭代的。</p>
<p>可迭代协议的约束如下：</p>
<ol>
<li>对象必须有一个知名符号属性（Symbol.iterator）</li>
<li>该属性必须是一个无参的迭代器创建函数</li>
</ol>
<h2 id="for-of-循环的原理"><a href="#for-of-循环的原理" class="headerlink" title="for-of 循环的原理"></a>for-of 循环的原理</h2><p>调用对象的[Symbol.iterator]方法，得到一个迭代器。不断调用 next 方法，只有返回的 done 为 false，则将返回的 value 传递给变量，然后进入循环体执行一次。<br>​</p>
<h1 id="生成器-generator"><a href="#生成器-generator" class="headerlink" title="生成器 generator"></a>生成器 generator</h1><h2 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h2><p>生成器：由构造函数 Generator 创建的对象，该对象既是一个迭代器，同时，又是一个可迭代对象（满足可迭代协议的对象）</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//伪代码</span>

<span class="token keyword">var</span> generator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
generator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//它具有next方法</span>
<span class="token keyword">var</span> iterator <span class="token operator">=</span> generator<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//它也是一个可迭代对象</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> generator<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">//由于它是一个可迭代对象，因此也可以使用for of循环</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>注意：Generator 构造函数，不提供给开发者使用，仅作为 JS 引擎内部使用</strong></p>
<h2 id="generator-function"><a href="#generator-function" class="headerlink" title="generator function"></a>generator function</h2><p>生成器函数（生成器创建函数）：该函数用于创建一个生成器。</p>
<p>ES6 新增了一个特殊的函数，叫做生成器函数，只要在函数名与 function 关键字之间加上一个*号，则该函数会自动返回一个生成器</p>
<p>生成器函数的特点：</p>
<ol>
<li>调用生成器函数，会返回一个生成器，而不是执行函数体（因为，生成器函数的函数体执行，收到生成器控制）</li>
<li>每当调用了生成器的 next 方法，生成器的函数体会从上一次 yield 的位置（或开始位置）运行到下一个 yield<ol>
<li>yield 关键字只能在生成器内部使用，不可以在普通函数内部使用</li>
<li>它表示暂停，并返回一个当前迭代的数据</li>
<li>如果没有下一个 yield，到了函数结束，则生成器的 next 方法得到的结果中的 done 为 true</li>
</ol>
</li>
<li>yield 关键字后面的表达式返回的数据，会作为当前迭代的数据</li>
<li>生成器函数的返回值，会作为迭代结束时的 value<ol>
<li>但是，如果在结束过后，仍然反复调用 next，则 value 为 undefined</li>
</ol>
</li>
<li>生成器调用 next 的时候，可以传递参数，该参数会作为生成器函数体上一次 yield 表达式的值。<ol>
<li>生成器第一次调用 next 函数时，传递参数没有任何意义</li>
</ol>
</li>
<li>生成器带有一个 throw 方法，该方法与 next 的效果相同，唯一的区别在于：<ol>
<li>next 方法传递的参数会被返回成一个正常值</li>
<li>throw 方法传递的参数是一个错误对象，会导致生成器函数内部发生一个错误。</li>
</ol>
</li>
<li>生成器带有一个 return 方法，该方法会直接结束生成器函数</li>
<li>若需要在生成器内部调用其他生成器，注意：如果直接调用，得到的是一个生成器，如果加入*号调用，则进入其生成器内部执行。如果是<code>yield* 函数()</code>调用生成器函数，则该函数的返回结果，为该表达式的结果</li>
</ol>
<h1 id="redux-saga"><a href="#redux-saga" class="headerlink" title="redux-saga"></a>redux-saga</h1><blockquote>
<p>中文文档地址：<a target="_blank" rel="noopener" href="https://redux-saga-in-chinese.js.org/">https://redux-saga-in-chinese.js.org/</a></p>
</blockquote>
<ul>
<li>纯净，不像前两种方式那样污染 action</li>
<li>强大</li>
<li>灵活</li>
<li>saga 不会像前两种方式那样阻止 action 的移交</li>
</ul>
<p><strong>在 saga 任务中，如果 yield 了一个普通数据，saga 不作任何处理，仅仅将数据传递给 yield 表达式（把得到的数据放到 next 的参数中），因此，在 saga 中，yield 一个普通数据没什么意义。</strong></p>
<p>saga 需要你在 yield 后面放上一些合适的 saga 指令（saga effects），如果放的是指令，saga 中间件会根据不同的指令进行特殊处理，以控制整个任务的流程。</p>
<p>每个指令本质上就是一个函数，该函数调用后，会返回一个指令对象，saga 会接收到该指令对象，进行各种处理</p>
<p><strong>一旦 saga 任务完成（生成器函数运行完成），则 saga 中间件一定结束</strong></p>
<ul>
<li>take 指令：【阻塞】监听某个 action，如果 action 发生了，则会进行下一步处理，take 指令仅监听一次。<strong>yield 返回的是完整的 action 对象</strong></li>
<li>all 指令：【阻塞】该函数传入一个数组，数组中放入生成器，saga 会等待<strong>所有的生成器全部完成后才会进一步处理</strong></li>
<li>takeEvery 指令：【不阻塞】不断的<strong>监听某个 action</strong>，当某个 action 到达之后，运行一个函数。<strong>takeEvery 永远不会结束当前的生成器。所以可以监听多个 action</strong></li>
<li>delay 指令：【阻塞】阻塞指定的毫秒数</li>
<li><strong>put</strong>指令：用于重新触发 action，<strong>相当于 dispatch 一个 action</strong></li>
<li><strong>call</strong>指令：【可能阻塞，是<strong>promise</strong>就阻塞】用于<strong>副作用（通常是异步）函数调用</strong></li>
<li><strong>apply</strong>指令：【可能阻塞】用于副作用（通常是异步）函数调用</li>
<li>select 指令：用于得到当前仓库中的数据</li>
<li>cps 指令：【可能阻塞】用于调用那些传统的回调方式的异步函数</li>
<li>fork：用于开启一个新的任务，该任务不会阻塞，该函数需要传递一个生成器函数，fork 返回了一个对象，类型为 Task</li>
<li>cancel：用于取消一个或多个任务，实际上，取消的实现原理，是利用 generator.return。cancel 可以不传递参数，如果不传递参数，则取消当前任务线。</li>
<li>takeLastest：功能和 takeEvery 一致，只不过，会自动取消掉之前开启的任务</li>
<li>cancelled：判断当前任务线是否被取消掉了</li>
<li>race：【阻塞】竞赛，可以传递多个指令，当其中任何一个指令结束后，会直接结束，与 Promise.race 类似。返回的结果，是最先完成的指令结果。并且，该函数会自动取消其他的任务</li>
</ul>
<h1 id="手写-saga（难度极高，工作后研究）"><a href="#手写-saga（难度极高，工作后研究）" class="headerlink" title="手写 saga（难度极高，工作后研究）"></a>手写 saga（难度极高，工作后研究）</h1><h1 id="redux-actions"><a href="#redux-actions" class="headerlink" title="redux-actions"></a>redux-actions</h1><blockquote>
<p>该库用于简化 action-types、action-creator 以及 reducer<br>官网文档：<a target="_blank" rel="noopener" href="https://redux-actions.js.org/">https://redux-actions.js.org/</a></p>
</blockquote>
<h2 id="createAction-s"><a href="#createAction-s" class="headerlink" title="createAction(s)"></a>createAction(s)</h2><h3 id="createAction"><a href="#createAction" class="headerlink" title="createAction"></a>createAction</h3><p>该函数用于帮助你创建一个 action 创建函数（action creator）</p>
<h3 id="createActions"><a href="#createActions" class="headerlink" title="createActions"></a>createActions</h3><p>该函数用于帮助你创建多个 action 创建函数</p>
<h2 id="handleAction-s"><a href="#handleAction-s" class="headerlink" title="handleAction(s)"></a>handleAction(s)</h2><h3 id="handleAction"><a href="#handleAction" class="headerlink" title="handleAction"></a>handleAction</h3><p>简化针对单个 action 类型的 reducer 处理，当它<strong>匹配到对应的 action 类型后，会执行对应的函数</strong></p>
<h3 id="handleActions"><a href="#handleActions" class="headerlink" title="handleActions"></a>handleActions</h3><p>简化针对多个 action 类型的 reducre 处理</p>
<h2 id="combineActions"><a href="#combineActions" class="headerlink" title="combineActions"></a>combineActions</h2><p>配合 createActions 和 handleActions 两个函数，用于处理多个 action-type 对应同一个 reducer 处理函数。</p>
<h1 id="react-redux"><a href="#react-redux" class="headerlink" title="react-redux"></a>react-redux</h1><ul>
<li>React: 组件化的 UI 界面处理方案</li>
<li>React-Router: 根据地址匹配路由，最终渲染不同的组件</li>
<li>Redux：处理数据以及数据变化的方案（主要用于处理共享数据）</li>
</ul>
<blockquote>
<p>如果一个组件，仅用于渲染一个 UI 界面，而没有状态（通常是一个函数组件），该组件叫做<strong>展示组件</strong><br>如果一个组件，仅用于提供数据，没有任何属于自己的 UI 界面，则该组件叫做<strong>容器组件</strong>，容器组件纯粹是为了给其他组件提供数据。</p>
</blockquote>
<p>react-redux 库：链接 redux 和 react</p>
<ul>
<li>Provider 组件：没有任何 UI 界面，该组件的作用，是将 redux 的仓库放到一个上下文中。</li>
<li>connect：高阶组件，用于链接仓库和组件的<ul>
<li>细节一：如果对返回的容器组件加上额外的属性，则这些属性会直接传递到展示组件</li>
<li>第一个参数：mapStateToProps:<ul>
<li>参数 1：整个仓库的状态</li>
<li>参数 2：使用者传递的属性对象</li>
</ul>
</li>
<li>第二个参数：<ul>
<li>情况 1：传递一个函数 mapDispatchToProps<ul>
<li>参数 1：dispatch 函数</li>
<li>参数 2：使用者传递的属性对象</li>
<li>函数返回的对象会作为属性传递到展示组件中（作为事件处理函数存在）</li>
</ul>
</li>
<li>情况 2：传递一个对象，对象的每个属性是一个 action 创建函数，当事件触发时，会自动的 dispatch 函数返回的 action</li>
</ul>
</li>
<li>细节二：如果不传递第二个参数，通过 connect 连接的组件，会自动得到一个属性：dispatch，使得组件有能力自行触发 action，但是，不推荐这样做。</li>
</ul>
</li>
</ul>
<p>知识</p>
<blockquote>
</blockquote>
<blockquote>
<ol>
<li>chrome 插件：redux-devtools</li>
<li>使用 npm 安装第三方库：redux-devtools-extension</li>
</ol>
</blockquote>
<h1 id="redux-和-router-的结合（connected-react-router）"><a href="#redux-和-router-的结合（connected-react-router）" class="headerlink" title="redux 和 router 的结合（connected-react-router）"></a>redux 和 router 的结合（connected-react-router）</h1><blockquote>
<p>希望把路由信息放进仓库统一管理的时候才需要这个库</p>
</blockquote>
<p>用于将 redux 和 react-router 进行结合</p>
<p>本质上，router 中的某些数据可能会跟数据仓库中的数据进行联动</p>
<p>该组件会将下面的路由数据和仓库保持同步</p>
<ol>
<li>action：它不是 redux 的 action，它表示当前路由跳转的方式（PUSH、POP、REPLACE）</li>
<li>location：它记录了当前的地址信息</li>
</ol>
<p>该库中的内容：</p>
<h2 id="connectRouter"><a href="#connectRouter" class="headerlink" title="connectRouter"></a>connectRouter</h2><p>这是一个函数，调用它，会返回一个用于管理仓库中路由信息的 reducer，该函数需要传递一个参数，参数是一个 history 对象。该对象，可以使用第三方库 history 得到。</p>
<h2 id="routerMiddleware"><a href="#routerMiddleware" class="headerlink" title="routerMiddleware"></a>routerMiddleware</h2><p>该函数会返回一个 redux 中间件，用于拦截一些特殊的 action</p>
<h2 id="ConnectedRouter"><a href="#ConnectedRouter" class="headerlink" title="ConnectedRouter"></a>ConnectedRouter</h2><p>这是一个组件，用于向上下文提供一个 history 对象和其他的路由信息（与 react-router 提供的信息一致）</p>
<p>之所以需要新制作一个组件，是因为该库必须保证整个过程使用的是同一个 history 对象</p>
<h2 id="一些-action-创建函数"><a href="#一些-action-创建函数" class="headerlink" title="一些 action 创建函数"></a>一些 action 创建函数</h2><ul>
<li>push</li>
<li>replace</li>
</ul>
<h1 id="dva"><a href="#dva" class="headerlink" title="dva"></a>dva</h1><blockquote>
<p>官方网站：<a target="_blank" rel="noopener" href="https://dvajs.com/">https://dvajs.com</a><br>dva 不仅仅是一个第三方库，更是一个框架，它主要整合了 redux 的相关内容，让我们处理数据更加容易，实际上，dva 依赖了很多：react、react-router、redux、redux-saga、react-redux、connected-react-router 等。</p>
</blockquote>
<h1 id="dva-的使用"><a href="#dva-的使用" class="headerlink" title="dva 的使用"></a>dva 的使用</h1><ol>
<li> dva 默认导出一个函数，通过调用该函数，可以得到一个 dva 对象</li>
<li> dva 对象.router：路由方法，传入一个函数，该函数返回一个 React 节点，将来，应用程序启动后，会自动渲染该节点。</li>
<li> dva 对象.start: 该方法用于启动 dva 应用程序，可以认为启动的就是 react 程序，该函数传入一个选择器，用于选中页面中的某个 dom 元素，react 会将内容渲染到该元素内部。</li>
<li> dva 对象.model: 该方法用于定义一个模型，该模型可以理解为 redux 的 action、reducer、redux-saga 副作用处理的整合，整合成一个对象，将该对象传入 model 方法即可。</li>
<li> namespace：命名空间，该属性是一个字符串，字符串的值，会被作为仓库中的属性保存</li>
<li> state：该模型的默认状态</li>
<li> reducers: 该属性配置为一个对象，对象中的每个方法就是一个 reducer，dva 约定，方法的名字，就是匹配的 action 类型</li>
<li>effects: 处理副作用，底层是使用 redux-saga 实现的，该属性配置为一个对象，对象中的每隔方法均处理一个副作用，方法的名字，就是匹配的 action 类型。<ol>
<li>函数的参数 1：action</li>
<li>参数 2：封装好的 saga/effects 对象</li>
</ol>
</li>
<li> subscriptions：配置为一个对象，该对象中可以写任意数量任意名称的属性，每个属性是一个函数，这些函数会在模型加入到仓库中后立即运行。</li>
<li> 在 dva 中同步路由到仓库</li>
<li> 在调用 dva 函数时，配置 history 对象</li>
<li> 使用 ConnectedRouter 提供路由上下文</li>
<li> 配置：</li>
<li> history：同步到仓库的 history 对象</li>
<li> initialState：创建 redux 仓库时，使用的默认状态</li>
<li> onError: 当仓库的运行发生错误的时候，运行的函数</li>
<li>onAction: 可以配置 redux 中间件<ol>
<li>传入一个中间件对象</li>
<li>传入一个中间件数组</li>
</ol>
</li>
<li> onStateChange: 当仓库中的状态发生变化时运行的函数</li>
<li> onReducer：对模型中的 reducer 的进一步封装</li>
<li> onEffect：类似于对模型中的 effect 的进一步封装</li>
<li> extraReducers：用于配置额外的 reducer，它是一个对象，对象的每一个属性是一个方法，每个方法就是一个需要合并的 reducer，方法名即属性名。</li>
<li> extraEnhancers: 它是用于封装 createStore 函数的，dva 会将原来的仓库创建函数作为参数传递，返回一个新的用于创建仓库的函数。函数必须放置到数组中。</li>
</ol>
<h1 id="dva-插件"><a href="#dva-插件" class="headerlink" title="dva 插件"></a>dva 插件</h1><p>通过<code>dva对象.use(插件)</code>，来使用插件，插件本质上就是一个对象，该对象与配置对象相同，dva 会在启动时，将传递的插件对象混合到配置中。</p>
<h2 id="dva-loading"><a href="#dva-loading" class="headerlink" title="dva-loading"></a>dva-loading</h2><p>该插件会在仓库中加入一个状态，名称为 loading，它是一个对象，其中有以下属性</p>
<ul>
<li>global：全局是否正在处理副作用（加载），只要有任何一个模型在处理副作用，则该属性为 true</li>
<li>models：一个对象，对象中的属性名以及属性的值，表示哪个对应的模型是否在处理副作用中（加载中）</li>
<li>effects：一个对象，对象中的属性名以及属性的值，表示是哪个 action 触发了副作用</li>
</ul>
<h1 id="umijs-简介"><a href="#umijs-简介" class="headerlink" title="umijs 简介"></a>umijs 简介</h1><blockquote>
<p>官网：<a target="_blank" rel="noopener" href="https://umijs.org/">https://umijs.org/</a></p>
</blockquote>
<p>umijs, nextjs(ssr 服务端渲染)，antd，antd-pro（antd+umijs）<br>​</p>
<ul>
<li>插件化<em>​</em></li>
<li>开箱即用</li>
<li>约定式路由</li>
</ul>
<h2 id="全局安装-umi"><a href="#全局安装-umi" class="headerlink" title="全局安装 umi"></a>全局安装 umi</h2><p>yarn global add umi</p>
<p>提供了一个命令行工具：umi，通过该命令可以对 umi 工程进行操作</p>
<blockquote>
<p>umi 还可以使用对应的脚手架</p>
</blockquote>
<ul>
<li>dev: 使用开发模式启动工程</li>
<li>build:打包</li>
</ul>
<h1 id="约定式路由"><a href="#约定式路由" class="headerlink" title="约定式路由"></a>约定式路由</h1><p>umi 对路由的处理，主要通过两种方式：</p>
<ol>
<li><strong>约定式</strong>：使用约定好的文件夹和文件，来代表页面，umi 会根据开发者书写的页面，生成路由配置。</li>
<li>配置式：直接书写路由配置文件</li>
</ol>
<h2 id="路由匹配"><a href="#路由匹配" class="headerlink" title="路由匹配"></a>路由匹配</h2><ul>
<li><p>umi 约定，工程中的 pages 文件夹中存放的是页面。如果工程包含 src 目录，则 src/pages 是页面文件夹。</p>
</li>
<li><p>umi 约定，页面的文件名，以及页面的文件路径，是该页面匹配的路由</p>
</li>
<li><p>umi 约定，如果页面的文件名是 index（不写 index 才能访问，写了反而不能访问了），则可以省略文件名（首页）(注意避免文件名和当前目录中的文件夹名称相同)</p>
</li>
<li><p>umi 约定，如果 src/layout 目录存在，则该目录中的 index.js 表示的是全局的通用布局，布局中的 children 则会添加具体的页面。</p>
</li>
<li><p>umi 约定，如果 pages 文件夹中包含_layout.js，则 layout.js 所在的目录以及其所有的子目录中的页面，共用该布局。</p>
</li>
<li><p>404 约定，umi 约定，pages/404.js，表示 404 页面，如果路由无匹配，则会渲染该页面。该约定在开发模式中无效，只有部署后生效。</p>
</li>
<li><p>使用$名称，会产生动态路由</p>
</li>
</ul>
<h2 id="路由跳转"><a href="#路由跳转" class="headerlink" title="路由跳转"></a>路由跳转</h2><ul>
<li>跳转链接： 导入<code>umi/link</code>，<code>umi/navlink</code></li>
<li>代码跳转： 导入<code>umi/router</code></li>
</ul>
<blockquote>
<p>导入模块时，@表示 src 目录</p>
</blockquote>
<h2 id="路由信息的获取"><a href="#路由信息的获取" class="headerlink" title="路由信息的获取"></a>路由信息的获取</h2><p>所有的页面、布局组件，都会通过属性 props，收到下面的属性</p>
<ul>
<li>match：等同于 react-router 的 match</li>
<li>history：等同于 react-router 的 history（history.location.query 被封装成了一个对象，使用的是 query-string 库进行的封装）</li>
<li>location：等同于 react-router 的 location（location.query 被封装成了一个对象，使用的是 query-string 库进行的封装）</li>
<li>route：对应的是路由配置</li>
</ul>
<p>如果需要在普通组件中获取路由信息，则需要使用 withRouter 封装，可以通过<code>umi/withRouter</code>导入</p>
<h1 id="配置式路由"><a href="#配置式路由" class="headerlink" title="配置式路由"></a>配置式路由</h1><p>当使用了路由配置后，约定式路由全部失效。</p>
<p>两种方式书写 umi 配置：</p>
<ol>
<li>使用根目录下的文件<code>.umirc.js</code></li>
<li>使用根目录下的文件<code>config/config.js</code></li>
</ol>
<p>进行路由配置时，每个配置就是一个匹配规则，并且，每个配置是一个对象，对象中的某些属性，会直接形成 Route 组件的属性</p>
<p>注意：</p>
<ul>
<li>component 配置项，需要填写页面组件的路径，路径相对于 pages 文件夹</li>
<li>如果配置项没有 exact，则会自动添加 exact 为 true</li>
<li>每一个路由配置，可以添加任何属性</li>
<li>Routes 属性是一个数组，数组的每一项是一个组件路径，路径相对于项目根目录，当匹配到路由后，会转而渲染该属性指定的组件，并会将 component 组件作为 children 放到匹配的组件中</li>
</ul>
<p>路由配置中的信息，同样可以放到约定式路由中，方式是，为约定式路由添加第一个文档注释（注释的格式的 YAML），需要将注释放到最开始的位置</p>
<p>YAML 格式</p>
<ul>
<li>键值对，冒号后需要加上空格</li>
<li>如果某个属性有多个键或多个值，需要进行缩进（空格，不能 tab）</li>
</ul>
<h1 id="使用-dva"><a href="#使用-dva" class="headerlink" title="使用 dva"></a>使用 dva</h1><blockquote>
<p>官方插件集 umi-plugin-react<br>文档：<a target="_blank" rel="noopener" href="https://umijs.org/zh/plugin/umi-plugin-react.html">https://umijs.org/zh/plugin/umi-plugin-react.html</a></p>
</blockquote>
<p>dva 插件和 umi 整合后，将模型分为两种：</p>
<ol>
<li>全局模型：所有页面通用，工程一开始启动后，模型就会挂载到仓库</li>
<li>局部模型：只能被某些页面使用，访问具体的页面时才会挂载到仓库</li>
</ol>
<h2 id="定义全局模型"><a href="#定义全局模型" class="headerlink" title="定义全局模型"></a>定义全局模型</h2><p>在<code>src/models</code>目录下定义的 js 文件都会被看作是全局模型，默认情况下，模型的命名空间和文件名一致。</p>
<h2 id="定义局部模型"><a href="#定义局部模型" class="headerlink" title="定义局部模型"></a>定义局部模型</h2><p>局部模型定义在 pages 文件夹或其子文件夹中，在哪个文件夹定义的模型，会被该文件夹中的所有页面以及子页面、以及该文件夹的祖先文件夹中的页面所共享。</p>
<p>局部模型的定义和全局模型的约定类似，需要创建一个 models 文件夹<br>​</p>
<h1 id="使用样式"><a href="#使用样式" class="headerlink" title="使用样式"></a>使用样式</h1><p>解决两个问题：</p>
<ol>
<li>保证类样式名称的唯一性：css-module</li>
<li>样式代码的重复：less 或 sass</li>
</ol>
<h2 id="局部样式和全局样式"><a href="#局部样式和全局样式" class="headerlink" title="局部样式和全局样式"></a>局部样式和全局样式</h2><p>底层使用了 webpack 的加载器：css-loader（内部包含了 css-module 的功能）</p>
<p>css 文件 -&gt; css-module -&gt; 对象</p>
<ol>
<li>某个组件特有的样式，不与其他组件共享，通常，将该样式文件与组件放置在同一个目录(非强制性)(要保证类样式名称唯一)</li>
<li>如果某些样式可能被某些组件共享，这样的样式，通常放到 assets/css 文件夹中。(要保证类样式名称唯一)</li>
<li>全局样式，名称一定唯一，不需要 css-module 处理。umijs 约定，src/global.css 样式，是全局样式，不会交给 css-module 处理。</li>
</ol>
<h2 id="less"><a href="#less" class="headerlink" title="less"></a>less</h2><p>less 代码 -&gt; less-loader -&gt; css 代码 -&gt; css-module -&gt; 对象<br>​</p>
<h1 id="代理和数据模拟"><a href="#代理和数据模拟" class="headerlink" title="代理和数据模拟"></a>代理和数据模拟</h1><h2 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h2><p>代理用于解决跨域问题</p>
<p>配置<code>.umirc.js</code>中的 proxy，配置方式和 devServer 中的 proxy 配置相同</p>
<h2 id="数据模拟"><a href="#数据模拟" class="headerlink" title="数据模拟"></a>数据模拟</h2><p>用于解决前后端协同开发的问题</p>
<p>数据模拟可以让前端开发者在开发时，无视后端接口是否真正完成，因为使用的是模拟的数据</p>
<p>umijs 约定：</p>
<ol>
<li>mock 文件夹中的文件</li>
<li>src/pages 文件夹中的_mock.js 文件</li>
</ol>
<p>以上两种 JS 文件，均会被 umijs 读取，并作为数据模拟的配置</p>
<p>可以自行发挥，添加模拟数据，通常，我们会和 mockjs 配合。<br>​</p>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="额外的约定文件"><a href="#额外的约定文件" class="headerlink" title="额外的约定文件"></a>额外的约定文件</h2><ul>
<li>src/pages/document.ejs: 页面模板文件</li>
<li>src/global.js：在 umi 最开始启动时运行的 js 文件</li>
<li>src/app.js：作运行时配置的代码<ul>
<li>patchRoutes: 函数，该函数会在 umi 读取完所有静态路由配置后执行</li>
<li>dva<ul>
<li>config： 相当于 new dva(<strong>配置</strong>)</li>
<li>plugins： 相当于 dva.use(插件)</li>
</ul>
</li>
</ul>
</li>
<li>.env: 配置环境变量，这些变量会在 umi 编译期间发挥作用<ul>
<li>UMI_ENV：umi 的环境变量值，可以是任意值，该值会影响到.umirc.js</li>
<li>PORT</li>
<li>MOCK</li>
</ul>
</li>
</ul>
<h2 id="umirc-配置"><a href="#umirc-配置" class="headerlink" title="umirc 配置"></a>umirc 配置</h2><h3 id="umi-配置"><a href="#umi-配置" class="headerlink" title="umi 配置"></a>umi 配置</h3><p>书写在.umirc.js 文件中的配置</p>
<ul>
<li>plugins：配置 umijs 的插件</li>
<li>routes：配置路由（会导致约定式路由失效）</li>
<li>history：history 对象模式（默认是 browser）</li>
<li>outputPath：使用 umi build 后，打包的目录名称，默认./dist</li>
<li>base: 相当于之前 BrowserRouter 中的 basename</li>
<li>publicPath: 指定静态资源所在的目录</li>
<li>exportStatic: 开启该配置后，会打包成多个静态页面，每个页面对应一个路由，开启多静态页面应用的前提条件是：没有动态路由</li>
</ul>
<h3 id="webpack-配置"><a href="#webpack-配置" class="headerlink" title="webpack 配置"></a>webpack 配置</h3><h1 id="umi-脚手架"><a href="#umi-脚手架" class="headerlink" title="umi 脚手架"></a>umi 脚手架</h1><p>create-umi<br>​</p>
<blockquote>
<p>yarn create-umi</p>
</blockquote>
<h1 id="Ant-Design"><a href="#Ant-Design" class="headerlink" title="Ant Design"></a>Ant Design</h1><blockquote>
<p>官网地址：<a target="_blank" rel="noopener" href="https://ant.design/">https://ant.design</a><br>对于前端开发者：antd 实际上就是一个 UI 库</p>
</blockquote>
<blockquote>
<p>网站 = 前台 + 后台<br>前台：给用户访问的页面，通常需要设计师参与制作<br>后台：给管理员（通常是公司内部员工）使用，通常设计师不参与后台页面。</p>
</blockquote>
<h2 id="Form"><a href="#Form" class="headerlink" title="Form"></a>Form</h2><ol>
<li> Form 组件：仅提供样式和事件</li>
<li> form 对象：处理数据验证、生成、获取</li>
<li> 获取 form 对象：通过 Form.create(配置)得到一个高阶组件，该高阶组件会将 form 对象作为属性，注入到传递的组件中</li>
<li>使用 form 对象<ol>
<li>getFieldDecorator：该方法用于产生一个表单元素，通过该方法产生的表单元素会被 form 对象控制</li>
</ol>
</li>
</ol>
<h1 id="上传接口"><a href="#上传接口" class="headerlink" title="上传接口"></a>上传接口</h1><p>请求地址：<a target="_blank" rel="noopener" href="http://101.132.72.36:5100/api/upload">http://101.132.72.36:5100/api/upload</a><br>请求方式：post<br>表单格式：form-data<br>表单域名称：imagefile<br>postman<br>服务器的响应结果</p>
<p>如果没有错误：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"访问路径"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>如果有错误：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"error"</span><span class="token operator">:</span> <span class="token string">"错误消息"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h1 id="Upload-组件"><a href="#Upload-组件" class="headerlink" title="Upload 组件"></a>Upload 组件</h1><p>本身不作任何显示，仅提供功能，要显示什么，需要作为该组件的内容传递<br>​</p>
<h1 id="其他常用组件-2"><a href="#其他常用组件-2" class="headerlink" title="其他常用组件 2"></a>其他常用组件 2</h1><h2 id="Carousel-轮播图"><a href="#Carousel-轮播图" class="headerlink" title="Carousel 轮播图"></a>Carousel 轮播图</h2><h2 id="Descriptions-描述列表"><a href="#Descriptions-描述列表" class="headerlink" title="Descriptions 描述列表"></a>Descriptions 描述列表</h2><h2 id="Empty-空状态"><a href="#Empty-空状态" class="headerlink" title="Empty 空状态"></a>Empty 空状态</h2><h2 id="Tooltip-文字提示"><a href="#Tooltip-文字提示" class="headerlink" title="Tooltip 文字提示"></a>Tooltip 文字提示</h2><h2 id="Modal-对话框"><a href="#Modal-对话框" class="headerlink" title="Modal 对话框"></a>Modal 对话框</h2>
                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Sunny</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2021/07/01/React/">http://example.com/2021/07/01/React/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Sunny</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Front-end-article/">
                                    <span class="chip bg-color">Front end article</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2021/07/01/React/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="React">
                        
                        <span class="card-title">React</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-07-01
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Sunny
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Front-end-article/">
                        <span class="chip bg-color">Front end article</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/06/29/Vue%E5%B0%B1%E4%B8%9A%E7%AF%87/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="Vue就业篇">
                        
                        <span class="card-title">Vue就业篇</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-29
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Sunny
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Front-end-article/">
                        <span class="chip bg-color">Front end article</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <a href="/about" target="_blank">Sunny</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
